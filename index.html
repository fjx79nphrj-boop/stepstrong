<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0f1117">
<title>Steadfast</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body, #root { min-height: 100vh; background: #0f1117; }
body { overscroll-behavior: none; }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
<script>
(function() {
  var origWarn = console.warn;
  console.warn = function() {
    if (arguments[0] && typeof arguments[0] === 'string' && arguments[0].indexOf('in-browser Babel') !== -1) return;
    origWarn.apply(console, arguments);
  };
})();
</script>
</head>
<body>
<div id="root"></div>
<script type="text/babel" data-type="module">
const { useState, useEffect, useRef, useMemo } = React;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEADFAST â€” Stepparent Relationship Tracker
Local-first PWA â€¢ No backend â€¢ IndexedDB
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */

// â”€â”€ Fonts: system fonts only (no external requests) â”€â”€

// â”€â”€ IndexedDB â”€â”€
const DB = â€œsteadfast_v1â€;
const VER = 1;
const S = { entries: â€œentriesâ€, profile: â€œprofileâ€, snapshots: â€œsnapshotsâ€ };

function idb() {
return new Promise((ok, fail) => {
const r = indexedDB.open(DB, VER);
r.onupgradeneeded = (e) => {
const d = e.target.result;
if (!d.objectStoreNames.contains(S.entries)) {
const s = d.createObjectStore(S.entries, { keyPath: â€œidâ€ });
s.createIndex(â€œdateâ€, â€œdateâ€);
}
if (!d.objectStoreNames.contains(S.profile))
d.createObjectStore(S.profile, { keyPath: â€œkeyâ€ });
if (!d.objectStoreNames.contains(S.snapshots))
d.createObjectStore(S.snapshots, { keyPath: â€œidâ€ });
};
r.onsuccess = () => ok(r.result);
r.onerror = () => fail(r.error);
});
}
async function put(s, d) { const db = await idb(); return new Promise((ok, f) => { const t = db.transaction(s, â€œreadwriteâ€); t.objectStore(s).put(d); t.oncomplete = () => ok(); t.onerror = () => f(t.error); }); }
async function getAll(s) { const db = await idb(); return new Promise((ok, f) => { const r = db.transaction(s, â€œreadonlyâ€).objectStore(s).getAll(); r.onsuccess = () => ok(r.result); r.onerror = () => f(r.error); }); }
async function get(s, k) { const db = await idb(); return new Promise((ok, f) => { const r = db.transaction(s, â€œreadonlyâ€).objectStore(s).get(k); r.onsuccess = () => ok(r.result); r.onerror = () => f(r.error); }); }
async function del(s, k) { const db = await idb(); return new Promise((ok, f) => { const t = db.transaction(s, â€œreadwriteâ€); t.objectStore(s).delete(k); t.oncomplete = () => ok(); t.onerror = () => f(t.error); }); }

// â”€â”€ Constants â”€â”€
const ACTIONS = [
{ id: â€œserviceâ€, label: â€œQuiet act of serviceâ€, icon: â€œğŸ«§â€, c: â€œ#7EB8A2â€ },
{ id: â€œactivityâ€, label: â€œShared activityâ€, icon: â€œğŸ¯â€, c: â€œ#8BAED4â€ },
{ id: â€œconversationâ€, label: â€œDirect conversationâ€, icon: â€œğŸ’¬â€, c: â€œ#C4A6D8â€ },
{ id: â€œgiftâ€, label: â€œGift or treatâ€, icon: â€œğŸâ€, c: â€œ#D4A574â€ },
{ id: â€œpresenceâ€, label: â€œBeing presentâ€, icon: â€œğŸª‘â€, c: â€œ#A8C5A0â€ },
{ id: â€œspaceâ€, label: â€œGave spaceâ€, icon: â€œğŸŒ¿â€, c: â€œ#9DB8C7â€ },
{ id: â€œboundaryâ€, label: â€œBoundary-settingâ€, icon: â€œğŸ›¡ï¸â€, c: â€œ#C9A0A0â€ },
];

const RESPONSES = [
{ id: â€œpositiveâ€, label: â€œPositive engagementâ€, icon: â€œâœ¨â€, c: â€œ#7EB8A2â€, score: 4 },
{ id: â€œneutralâ€, label: â€œNeutral acknowledgmentâ€, icon: â€œâ–â€, c: â€œ#9DB8C7â€, score: 3 },
{ id: â€œwithdrawalâ€, label: â€œPassive withdrawalâ€, icon: â€œğŸšªâ€, c: â€œ#C9A0A0â€, score: 2 },
{ id: â€œrejectionâ€, label: â€œActive rejectionâ€, icon: â€œğŸ”´â€, c: â€œ#D4796Bâ€, score: 1 },
{ id: â€œescalationâ€, label: â€œEscalationâ€, icon: â€œâš¡â€, c: â€œ#B85C4Fâ€, score: 0 },
];

const CONTEXTS = [
â€œMorningâ€, â€œAfternoonâ€, â€œEveningâ€, â€œNightâ€,
â€œAfter custody transitionâ€, â€œAfter bio-parent contactâ€,
â€œAfter discipline momentâ€, â€œDuring shared activityâ€,
â€œAt mealtimeâ€, â€œAt bedtimeâ€, â€œWeekendâ€, â€œSchool dayâ€,
â€œHoliday / special occasionâ€, â€œAfter argument with partnerâ€,
];

const CARDS = [
{
triggers: [â€œrejectionâ€, â€œescalationâ€],
title: â€œThe Loyalty Bindâ€,
body: â€œChildren often reject stepparents not because they dislike them, but because acceptance feels like betraying their biological parent. The rejection youâ€™re feeling is rarely about you â€” itâ€™s about the impossible emotional math the child is trying to solve.â€,
src: â€œBraithwaite et al., 2018â€,
quote: â€œ"It was all in my head. I wouldnâ€™t want to go out with my dadâ€™s family, because I didnâ€™t feel comfortable, nor did I feel like I fit in. It wasnâ€™t my stepmomâ€™s fault, nor my dadâ€™s."â€,
who: â€œFormer stepchild, now 30â€,
},
{
triggers: [â€œrejectionâ€],
title: â€œWhat Theyâ€™ll Rememberâ€,
body: â€œAdult stepchildren consistently report that the things they remember most are NOT grand gestures. Itâ€™s the ironed shirt. The medicine left without a word. The college fees paid quietly. Things done without any expectation of acknowledgment.â€,
quote: â€œ"She stopped trying to bond. But she still left medicine on my bedside when I was sick. Still paid my college application fees quietly. On my first job interview day, she ironed my shirt and said nothing else. That hurt more than any argument."â€,
who: â€œAdult stepchild reflectionâ€,
},
{
triggers: [â€œrejectionâ€, â€œescalationâ€],
title: â€œ"Youâ€™re Not My Real Parent"â€,
body: â€œThis phrase is the most commonly cited verbal weapon. But research shows it reflects the childâ€™s fear of losing their biological parent, not a genuine assessment. Children use it precisely because they know it will land â€” which paradoxically means the relationship matters enough to weaponize.â€,
quote: â€œ"Iâ€™m sorry I never gave you a chance; a fair, equal chance. I compared you to my father, and thought you were stealing my mother. I was afraid I was losing her. You taught me what a man should be to a woman."â€,
who: â€œAdult stepchild, looking backâ€,
},
{
triggers: [â€œwithdrawalâ€],
title: â€œWithdrawal Isnâ€™t Rejectionâ€,
body: â€œWhen a child withdraws â€” leaves the room, goes silent, avoids â€” it feels like rejection. But withdrawal is often a self-protective mechanism, not an offensive one. The child may be overwhelmed, processing, or simply not ready. Withdrawal is often a sign theyâ€™re aware of the relationship, not indifferent to it.â€,
quote: â€œ"When I felt her pullback as a kid, I felt she didnâ€™t care if I was there or not as long as she had my dad. And thatâ€™s what we donâ€™t want our bonus children thinking, they arenâ€™t wanted."â€,
who: â€œFormer stepchild perspectiveâ€,
},
{
triggers: [â€œneutralâ€, â€œpositiveâ€],
title: â€œNeutral Is Progressâ€,
body: â€œIn stepfamily dynamics, a neutral response IS a positive signal. If the child accepted what you offered without resistance â€” even without warmth â€” thatâ€™s movement. The path typically goes: hostility â†’ avoidance â†’ tolerance â†’ neutral acceptance â†’ occasional warmth. You may be further along than you think.â€,
src: â€œStepfamily integration typically takes 7â€“12 years. Neutral acceptance is a major milestone.â€,
},
{
triggers: [â€œrejectionâ€, â€œwithdrawalâ€, â€œescalationâ€],
title: â€œThe 2 AM Truthâ€,
body: â€œRight now, everything feels amplified. The rejection feels permanent. The effort feels wasted. But the stepparents who eventually break through are the ones who maintained consistent, low-pressure presence through exactly these moments. Your exhaustion is evidence of your commitment, not your failure.â€,
quote: â€œ"My car broke down on a highway at 2 am. I called him because my phone was dying. He reached in 40 minutes. Didnâ€™t lecture me. Just fixed the issue and waited till I got home. Later, he said, â€˜I know Iâ€™m not your first call. I just want to be a reliable one.â€™"â€,
who: â€œAdult stepchild about their stepdadâ€,
},
{
triggers: [â€œrejectionâ€, â€œwithdrawalâ€, â€œescalationâ€],
title: â€œYouâ€™re Not Becoming Someone Elseâ€,
body: â€œFeeling angry, resentful, or withdrawn doesnâ€™t mean youâ€™re becoming a bad stepparent. It means youâ€™re a committed adult experiencing sustained emotional labor without feedback. These feelings are a measurement problem, not a character flaw.â€,
quote: â€œ"I was experiencing an identity crisis as a stepmom. Not loving your stepchildren or feeling resentful or jealous does not make you a bad stepmom."â€,
who: â€œStepmom community postâ€,
},
{
triggers: [â€œpositiveâ€, â€œneutralâ€],
title: â€œAnchor This Momentâ€,
body: â€œYour brain is wired to weigh negative interactions more heavily than positive ones. This moment â€” this neutral or positive response â€” is real data. It happened. When the next difficult moment comes, youâ€™ll have concrete evidence that progress exists.â€,
src: â€œNegativity bias causes humans to weight negative events 3â€“5Ã— more heavily than positive ones.â€,
},
];

// â”€â”€ Daily Quotes (shown on Home, one per day) â”€â”€
const DAILY_QUOTES = [
// === REJECTION / ACTIVE RESISTANCE ===
{ q: â€œIâ€™m sorry I never gave you a chance. I compared you to my father, and thought you were stealing my mother. I was afraid I was losing her. You taught me what a man should be to a woman.â€, who: â€œAdult stepchild, looking backâ€, theme: â€œrejectionâ€ },
{ q: â€œShe stopped trying to bond. But she still left medicine on my bedside when I was sick. Still paid my college application fees quietly. On my first job interview day, she ironed my shirt and said nothing else. That hurt more than any argument.â€, who: â€œAdult stepchild reflectionâ€, theme: â€œinvisible-effortâ€ },
{ q: â€œMy car broke down on a highway at 2 AM. I called him because my phone was dying. He came in 40 minutes. Didnâ€™t lecture me. Just fixed the issue and waited till I got home. He said, â€˜I know Iâ€™m not your first call. I just want to be a reliable one.â€™â€, who: â€œAdult stepchild about their stepdadâ€, theme: â€œinvisible-effortâ€ },
{ q: â€œIt was all in my head. I wouldnâ€™t want to go out with my dadâ€™s family, because I didnâ€™t feel comfortable. It wasnâ€™t my stepmomâ€™s fault, nor my dadâ€™s.â€, who: â€œFormer stepchild, now 30â€, theme: â€œrejectionâ€ },
{ q: â€œI hated her for years. Not because she was bad â€” because she was there, and my mom wasnâ€™t. Thatâ€™s not fair, and I know that now. But a kid doesnâ€™t know that.â€, who: â€œAdult stepchild, age 28â€, theme: â€œrejectionâ€ },
// === INVISIBLE EFFORT / LONG GAME ===
{ q: â€œHe never tried to be my dad. He just kept showing up. Drove me places. Fixed things. Asked how school was, even when I gave one-word answers for three years straight. I didnâ€™t appreciate it until I was 25.â€, who: â€œFormer stepchild about stepdadâ€, theme: â€œinvisible-effortâ€ },
{ q: â€œShe made my lunch every day for five years and I never once said thank you. I think about that a lot now that I have my own kids.â€, who: â€œAdult stepchild, now a parentâ€, theme: â€œinvisible-effortâ€ },
{ q: â€œThe thing I remember most isnâ€™t any big conversation. Itâ€™s that he always saved me the corner piece of the brownies. Every single time. He noticed that about me when nobody else did.â€, who: â€œAdult stepchild, age 32â€, theme: â€œinvisible-effortâ€ },
{ q: â€œI used to slam my door every time she spoke to me. She never stopped knocking. Not to come in â€” just to say goodnight through the door. Every night for two years.â€, who: â€œFormer stepchild, now 26â€, theme: â€œinvisible-effortâ€ },
{ q: â€œWhen I got married, I asked my stepdad to walk me down the aisle. My mom cried. He cried. I cried. He had waited seventeen years for that moment and never once asked for it.â€, who: â€œAdult stepdaughterâ€, theme: â€œlong-viewâ€ },
// === PROGRESS / HOPE ===
{ q: â€œThe shift didnâ€™t happen all at once. One day I just realized Iâ€™d started calling her house â€˜homeâ€™ without thinking about it.â€, who: â€œFormer stepchild, age 24â€, theme: â€œprogressâ€ },
{ q: â€œI named my daughter after my stepmom. She doesnâ€™t know yet. Iâ€™m telling her at Christmas.â€, who: â€œAdult stepchildâ€, theme: â€œlong-viewâ€ },
{ q: â€œIt took me until I was 22 to tell him I loved him. But Iâ€™d felt it since I was 16. I just didnâ€™t know how to say it without feeling like I was betraying my real dad.â€, who: â€œAdult stepchild about loyalty conflictâ€, theme: â€œprogressâ€ },
{ q: â€œMy stepmom never corrected me when I called her by her first name. She never pushed. And thatâ€™s exactly why, twenty years later, my kids call her grandma.â€, who: â€œAdult stepchild, now 38â€, theme: â€œlong-viewâ€ },
// === VALIDATION / IDENTITY ===
{ q: â€œI wish someone had told my stepdad that my silence wasnâ€™t rejection. I was just scared that if I loved him, it meant I didnâ€™t love my dad anymore.â€, who: â€œFormer stepchild, now 27â€, theme: â€œrejectionâ€ },
{ q: â€œThe hardest part wasnâ€™t that she rejected me. It was that I started to believe I was the problem. I wasnâ€™t. The situation was the problem.â€, who: â€œStepparent of 8 yearsâ€, theme: â€œidentityâ€ },
{ q: â€œNobody told me that â€˜doing fineâ€™ was a realistic best-case for the first five years. I kept thinking I was failing when I was actually right on track.â€, who: â€œStepdad, year 7â€, theme: â€œidentityâ€ },
{ q: â€œYou donâ€™t have to love your stepkids the same way you love your bio kids. Different love is still love. I wish someone had given me permission to feel that earlier.â€, who: â€œStepmom, blended familyâ€, theme: â€œidentityâ€ },
// === ADDITIONAL FOR DAILY ROTATION ===
{ q: â€œLooking back, the fact that she stayed is the thing that mattered. Not what she said, not what she bought me. She just stayed.â€, who: â€œAdult stepchild, age 30â€, theme: â€œinvisible-effortâ€ },
{ q: â€œI wrote my stepmom a letter when I turned 30. Just to say sorry. And thank you. She framed it.â€, who: â€œAdult stepchildâ€, theme: â€œlong-viewâ€ },
{ q: â€œHe came to every single game. Even when I pretended he wasnâ€™t there. Especially when I pretended he wasnâ€™t there.â€, who: â€œFormer stepchild about stepdadâ€, theme: â€œinvisible-effortâ€ },
{ q: â€œMy stepmother taught me that family isnâ€™t just blood. Itâ€™s who stays when things are hard. She stayed.â€, who: â€œAdult stepchild, age 35â€, theme: â€œlong-viewâ€ },
{ q: â€œI used to test her constantly. Say horrible things just to see if sheâ€™d leave. She never did. Thatâ€™s the only reason I trust anyone now.â€, who: â€œFormer stepchild, now in therapyâ€, theme: â€œrejectionâ€ },
{ q: â€œThe relationship didnâ€™t get good. It got okay. And okay turned out to be more than enough.â€, who: â€œAdult stepchild about realistic outcomesâ€, theme: â€œprogressâ€ },
{ q: â€œI didnâ€™t go to her funeral because I was angry. I regret it every single day. She deserved better from me, and she probably knew that.â€, who: â€œAdult stepchild, age 45â€, theme: â€œlong-viewâ€ },
];

// â”€â”€ Partner Communication Tips â”€â”€
const PARTNER_TIPS = [
{
title: â€œMake the invisible visibleâ€,
situation: â€œYour partner doesnâ€™t seem to notice your efforts with their child.â€,
tip: â€œDonâ€™t wait for them to notice. Share specific moments: â€˜I made their lunch today and they walked past me without a word. I know thatâ€™s normal, but it would help me to hear that you see what Iâ€™m doing.â€™â€,
why: â€œPartners often assume stepparents know their efforts are appreciated. They donâ€™t realize you need explicit acknowledgment because youâ€™re not getting any from the child.â€,
},
{
title: â€œThe united front conversationâ€,
situation: â€œYou feel undermined when your partner overrides your decisions in front of the child.â€,
tip: â€œTry: â€˜When we disagree about rules, can we talk about it privately first? When it happens in front of the kids, it signals that I donâ€™t have authority here â€” and that makes it harder for them to respect me.â€™â€,
why: â€œChildren in stepfamilies are highly attuned to power dynamics. If they see the bio-parent override the stepparent, it confirms their belief that the stepparent doesnâ€™t count.â€,
},
{
title: â€œDonâ€™t compete with the other parentâ€,
situation: â€œYour partner compares you to the childâ€™s other biological parent, or expects you to fill that role.â€,
tip: â€œSay: â€˜Iâ€™m not trying to replace anyone. Iâ€™m trying to build my own relationship with your child. That takes time, and it will look different from what they have with their other parent â€” and thatâ€™s okay.â€™â€,
why: â€œStepparents who try to replicate the bio-parent role face the most resistance. Research consistently shows that a â€˜friendly mentorâ€™ role leads to better outcomes than a â€˜replacement parentâ€™ role.â€,
},
{
title: â€œWhen you need space from the childâ€,
situation: â€œYou need a break but feel guilty asking.â€,
tip: â€œTry: â€˜I need an hour to reset after today. Thatâ€™s not me giving up â€” itâ€™s me making sure I can show up again tomorrow. Can you handle bedtime tonight?â€™â€,
why: â€œStepparent burnout is real and under-discussed. Taking breaks isnâ€™t abandonment. Partners need to understand that sustained effort requires recovery.â€,
},
{
title: â€œSharing your Steadfast dataâ€,
situation: â€œYour partner asks how things are going, and you want to show them â€” not just tell them.â€,
tip: â€œUse the monthly report to share patterns: â€˜Look â€” when I use quiet acts of service, the response is neutral or positive 70% of the time. Direct conversation only works 30%. This is real data, not just my feelings.â€™â€,
why: â€œData removes the emotion from the conversation. Your partner can see objective patterns instead of hearing what might sound like complaints.â€,
},
{
title: â€œWhen your partner says â€˜just give it timeâ€™â€,
situation: â€œYouâ€™re struggling and your partner minimizes it with â€˜theyâ€™ll come around.â€™â€,
tip: â€œRespond: â€˜I hear you, and I know time matters. But right now, I need you to acknowledge that this is hard â€” not solve it, just see it. Can you just sit with me in this for a minute?â€™â€,
why: â€œâ€˜Give it timeâ€™ feels dismissive even when itâ€™s true. What stepparents need in the moment is validation, not advice. Partners often default to fixing because the pain is uncomfortable to witness.â€,
},
{
title: â€œAsking for backup without starting a fightâ€,
situation: â€œThe child was disrespectful to you and your partner didnâ€™t intervene.â€,
tip: â€œWait until youâ€™re calm, then: â€˜When [specific thing] happened today and nothing was said, I felt unsupported. Iâ€™m not asking you to punish them â€” Iâ€™m asking you to say something in the moment, even something small, so they know thatâ€™s not okay.â€™â€,
why: â€œBio-parents often freeze when caught between their child and their partner. They need specific, small requests â€” not general demands to â€˜do something.â€™â€,
},
{
title: â€œThe loyalty conflict isnâ€™t about youâ€,
situation: â€œYour partnerâ€™s child acts worse after visits with their other parent.â€,
tip: â€œTell your partner: â€˜Iâ€™ve noticed the pattern too. Itâ€™s not about us doing something wrong â€” theyâ€™re processing loyalty conflict. The best thing we can do is keep things calm and predictable when they come back.â€™â€,
why: â€œChildren often act out after custody transitions because they feel guilty for enjoying time with the other household. Naming this pattern together reduces blame.â€,
},
];

// â”€â”€ Parental Alienation Content â”€â”€
const ALIENATION = {
title: â€œWhen itâ€™s more than normal resistanceâ€,
intro: â€œParental alienation â€” when one parent actively turns a child against the other parent or stepparent â€” is a specific and severe dynamic that goes beyond typical stepfamily adjustment. If youâ€™re experiencing this, itâ€™s important to know that standard stepparenting strategies may not apply.â€,
signs: [
â€œThe child repeats word-for-word phrases that sound like an adultâ€™s language, not a childâ€™sâ€,
â€œRejection escalated suddenly after contact with the other parent, with no other triggerâ€,
â€œThe child shows no ambivalence â€” theyâ€™re entirely negative with zero mixed feelingsâ€,
â€œPreviously warm interactions disappeared overnightâ€,
â€œThe child makes false accusations or dramatically rewrites shared historyâ€,
],
guidance: [
{ title: â€œThis is not your faultâ€, text: â€œAlienation is a form of psychological manipulation by an adult. No amount of â€˜trying harderâ€™ on your part will fix it, because the problem isnâ€™t coming from you or the child.â€ },
{ title: â€œDocument, donâ€™t reactâ€, text: â€œKeep factual records of what the child says and when. Your Steadfast entries can serve this purpose. Note specific phrases, dates, and context â€” especially correlation with custody transitions.â€ },
{ title: â€œProtect the relationship you canâ€, text: â€œFocus on your relationship with your partner. Alienation puts enormous strain on couples. Your partner needs to be actively involved in addressing this â€” it cannot be your fight alone.â€ },
{ title: â€œSeek specialized helpâ€, text: â€œGeneral stepfamily advice often doesnâ€™t apply to alienation. Look for therapists who specifically work with parental alienation or high-conflict custody situations.â€ },
{ title: â€œLower your expectations without giving upâ€, text: â€œProgress in alienation cases is measured differently. A child maintaining any neutral contact at all may be the realistic best outcome while the alienation is active. This doesnâ€™t mean forever.â€ },
],
note: â€œSteadfastâ€™s tracking tools can still be useful in alienation situations â€” documenting patterns, correlating behaviors with custody transitions, and maintaining your own perspective. But the perspective cards and benchmarks are designed for typical stepfamily resistance, not active alienation. If youâ€™re in this situation, please adjust your expectations of this app and of yourself.â€,
};

const BENCH = {
ages: {
â€œ0-4â€: { t: â€œ3â€“6 yearsâ€, note: â€œYoung children are generally more accepting but may develop resistance as they understand family dynamics.â€ },
â€œ5-9â€: { t: â€œ5â€“8 yearsâ€, note: â€œSchool-age children have established bonds and may feel torn between loyalty to their biological parent and acceptance of you.â€ },
â€œ10-13â€: { t: â€œ7â€“12 yearsâ€, note: â€œPre-teens and early teens face the hardest adjustment. Identity formation plus loyalty conflicts create intense resistance.â€ },
â€œ14-17â€: { t: â€œMay extend into adulthoodâ€, note: â€œTeenagers are developmentally separating from ALL parents. Adding a new one at this stage is exceptionally challenging. Progress often only becomes visible when theyâ€™re adults.â€ },
},
custody: {
full: â€œLiving together full-time creates more friction but also more opportunities for small positive interactions.â€,
â€œ50-50â€: â€œRegular transitions can trigger loyalty conflicts each time. But consistent presence normalizes the relationship.â€,
weekends: â€œLimited time means each interaction carries more weight â€” both positive and negative. Slower overall progress.â€,
other: â€œIrregular or infrequent contact makes relationship-building significantly harder.â€,
},
loyalty: {
none: â€œNo visible loyalty conflict is a significant advantage. Progress may be faster than typical benchmarks.â€,
mild: â€œSome tension is normal. The child may feel conflicted but isnâ€™t actively pressured to reject you.â€,
strong: â€œActive loyalty conflict is the single biggest predictor of slower integration. This is the hardest variable, and itâ€™s not something you control.â€,
unknown: â€œNot being sure is common. Watch for signs: does the child seem conflicted after visits with the other parent?â€,
},
outcomes: [
{ l: â€œWarm acceptanceâ€, d: â€œGenuine affection, seeks your company, introduces you as family.â€, p: â€œ15â€“20%â€, c: â€œ#7EB8A2â€ },
{ l: â€œComfortable relationshipâ€, d: â€œEasy coexistence, shared activities, mutual respect.â€, p: â€œ30â€“35%â€, c: â€œ#8BAED4â€ },
{ l: â€œRespectful distanceâ€, d: â€œPolite, cooperative, but not close. A realistic and valid success state.â€, p: â€œ25â€“30%â€, c: â€œ#9DB8C7â€ },
{ l: â€œCordial coexistenceâ€, d: â€œFunctional household, minimal friction, limited emotional connection.â€, p: â€œ15â€“20%â€, c: â€œ#C9A0A0â€ },
{ l: â€œOngoing difficultyâ€, d: â€œContinued resistance that may soften in adulthood â€” or may not.â€, p: â€œ5â€“10%â€, c: â€œ#D4796Bâ€ },
],
};

const SNAP_Q = [
{ id: â€œoverallâ€, q: â€œHow would you describe the relationship right now?â€, s: [â€œHostileâ€, â€œAvoidantâ€, â€œTenseâ€, â€œNeutralâ€, â€œWarmingâ€, â€œComfortableâ€, â€œCloseâ€] },
{ id: â€œrejâ€, q: â€œHow often are you experiencing overt rejection?â€, s: [â€œDailyâ€, â€œSeveral/wkâ€, â€œWeeklyâ€, â€œFew/monthâ€, â€œRarelyâ€, â€œAlmost neverâ€] },
{ id: â€œposâ€, q: â€œHow often do you notice small positive signals?â€, s: [â€œNeverâ€, â€œRarelyâ€, â€œSometimesâ€, â€œWeeklyâ€, â€œSeveral/wkâ€, â€œDailyâ€] },
{ id: â€œfeelingâ€, q: â€œHow are YOU feeling about the relationship?â€, s: [â€œHopelessâ€, â€œExhaustedâ€, â€œDiscouragedâ€, â€œNeutralâ€, â€œCautious hopeâ€, â€œGoodâ€, â€œConfidentâ€] },
{ id: â€œidentityâ€, q: â€œHow much are you feeling like yourself?â€, s: [â€œLostâ€, â€œStrugglingâ€, â€œCopingâ€, â€œMostly OKâ€, â€œMyselfâ€, â€œStrongerâ€] },
{ id: â€œsustainâ€, q: â€œHow sustainable does your current effort feel?â€, s: [â€œBurning outâ€, â€œUnsustainableâ€, â€œDifficultâ€, â€œManageableâ€, â€œComfortableâ€, â€œNaturalâ€] },
];

// â”€â”€ Helpers â”€â”€
const uid = () => Date.now().toString(36) + Math.random().toString(36).slice(2, 7);
const fmtDate = (d) => new Date(d).toLocaleDateString(â€œen-USâ€, { month: â€œshortâ€, day: â€œnumericâ€, year: â€œnumericâ€ });
const fmtShort = (d) => new Date(d).toLocaleDateString(â€œen-USâ€, { month: â€œshortâ€, day: â€œnumericâ€ });
const daysAgo = (d) => Math.round((Date.now() - new Date(d).getTime()) / 86400000);

// â”€â”€ Palette â”€â”€
const P = {
bg: â€œ#0f1117â€, card: â€œ#161921â€, card2: â€œ#1c2029â€, border: â€œ#252a35â€,
border2: â€œ#2f3542â€, warm: â€œ#D4A574â€, warmDim: â€œ#D4A57444â€,
text: â€œ#E5D5C5â€, muted: â€œ#9CA3AFâ€, dim: â€œ#6B7280â€, dimmer: â€œ#4B5563â€,
green: â€œ#7EB8A2â€, blue: â€œ#8BAED4â€, purple: â€œ#C4A6D8â€, rose: â€œ#C9A0A0â€, red: â€œ#D4796Bâ€,
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  MAIN APP
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function App() {
const [view, setView] = useState(â€œloadingâ€);
const [entries, setEntries] = useState([]);
const [profile, setProfile] = useState(null);
const [snaps, setSnaps] = useState([]);
const [modal, setModal] = useState(null); // {type, data?}
const [timeRange, setTimeRange] = useState(â€œ3mâ€);
const [patMode, setPatMode] = useState(â€œactionâ€);

useEffect(() => {
(async () => {
try {
const [e, p, s] = await Promise.all([getAll(S.entries), get(S.profile, â€œmainâ€), getAll(S.snapshots)]);
setEntries(e.sort((a, b) => new Date(b.date) - new Date(a.date)));
setProfile(p?.data || null);
setSnaps(s.sort((a, b) => new Date(a.date) - new Date(b.date)));
setView(p?.data ? â€œhomeâ€ : â€œonboardâ€);
} catch { setView(â€œonboardâ€); }
})();
}, []);

const saveEntry = async (e) => { await put(S.entries, e); setEntries(prev => [e, â€¦prev.filter(x => x.id !== e.id)].sort((a, b) => new Date(b.date) - new Date(a.date))); };
const delEntry = async (id) => { await del(S.entries, id); setEntries(prev => prev.filter(x => x.id !== id)); };
const saveProfile = async (d) => { await put(S.profile, { key: â€œmainâ€, data: d }); setProfile(d); };
const saveSnap = async (s) => { await put(S.snapshots, s); setSnaps(prev => [â€¦prev.filter(x => x.id !== s.id), s].sort((a, b) => new Date(a.date) - new Date(b.date))); };
const delSnap = async (id) => { await del(S.snapshots, id); setSnaps(prev => prev.filter(x => x.id !== id)); };

const exportData = () => {
const d = JSON.stringify({ entries, profile, snapshots: snaps, exported: new Date().toISOString() }, null, 2);
const a = document.createElement(â€œaâ€);
a.href = URL.createObjectURL(new Blob([d], { type: â€œapplication/jsonâ€ }));
a.download = `steadfast-backup-${new Date().toISOString().slice(0, 10)}.json`;
a.click();
};

const importData = (evt) => {
const f = evt.target.files[0];
if (!f) return;
const r = new FileReader();
r.onload = async (e) => {
try {
const d = JSON.parse(e.target.result);
if (d.entries) for (const x of d.entries) await put(S.entries, x);
if (d.profile) await put(S.profile, { key: â€œmainâ€, data: d.profile });
if (d.snapshots) for (const x of d.snapshots) await put(S.snapshots, x);
window.location.reload();
} catch { alert(â€œInvalid backup file.â€); }
};
r.readAsText(f);
};

const openEntry = (e = null) => setModal({ type: â€œentryâ€, data: e });
const close = () => setModal(null);

if (view === â€œloadingâ€) return (
<div style={{ â€¦css.root, display: â€œflexâ€, alignItems: â€œcenterâ€, justifyContent: â€œcenterâ€, minHeight: â€œ100vhâ€ }}>
<p style={{ color: P.dim, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, fontSize: 18 }}>Loadingâ€¦</p>
</div>
);

if (view === â€œonboardâ€) return <Onboarding onDone={(d) => { saveProfile(d); setView(â€œhomeâ€); }} />;

return (
<div style={css.root}>
<div style={css.shell}>
{/* Modal layer */}
{modal?.type === â€œentryâ€ && (
<EntryModal
entry={modal.data}
onSave={(e) => {
saveEntry(e); close();
if (e.response === â€œrejectionâ€ || e.response === â€œescalationâ€) {
const cs = CARDS.filter(c => c.triggers.includes(e.response));
if (cs.length) setTimeout(() => setModal({ type: â€œcardâ€, data: cs[Math.floor(Math.random() * cs.length)] }), 300);
}
}}
onDelete={modal.data ? (id) => { delEntry(id); close(); } : null}
onClose={close}
/>
)}
{modal?.type === â€œcardâ€ && <CardModal card={modal.data} onClose={close} />}
{modal?.type === â€œsnapâ€ && <SnapModal snaps={snaps} onSave={(s) => { saveSnap(s); close(); }} onClose={close} />}
{modal?.type === â€œsettingsâ€ && <SettingsModal onClose={close} onExport={exportData} onImport={importData} onRedo={() => { setView(â€œonboardâ€); close(); }} />}

```
    {/* Header */}
    <header style={css.hdr}>
      <div>
        <h1 style={css.logo}>Steadfast</h1>
        <p style={css.sub}>Your progress is real, even when it's invisible</p>
      </div>
      <button onClick={() => setModal({ type: "settings" })} style={css.iconBtn} aria-label="Settings">âš™</button>
    </header>

    <Nav view={view} go={setView} />

    <main style={{ padding: "4px 16px 120px" }}>
      {view === "home" && <Home entries={entries} profile={profile} snaps={snaps} openEntry={openEntry} openSnap={() => setModal({ type: "snap" })} openCard={() => { const c = CARDS[Math.floor(Math.random() * CARDS.length)]; setModal({ type: "card", data: c }); }} />}
      {view === "timeline" && <Timeline entries={entries} snaps={snaps} range={timeRange} setRange={setTimeRange} openEntry={openEntry} />}
      {view === "patterns" && <Patterns entries={entries} mode={patMode} setMode={setPatMode} />}
      {view === "perspective" && <Perspective entries={entries} openCard={(c) => setModal({ type: "card", data: c })} />}
      {view === "partner" && <Partner entries={entries} profile={profile} snaps={snaps} />}
      {view === "benchmark" && <Benchmark profile={profile} snaps={snaps} entries={entries} openSnap={() => setModal({ type: "snap" })} onDeleteSnap={delSnap} />}
    </main>

    {/* FAB */}
    <button onClick={() => openEntry()} style={css.fab} aria-label="Log interaction">
      <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
    </button>
  </div>
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Nav({ view, go }) {
const items = [
{ id: â€œhomeâ€, label: â€œHomeâ€, ico: â€œâŠ™â€ },
{ id: â€œtimelineâ€, label: â€œTimelineâ€, ico: â€œâ”â€ },
{ id: â€œpatternsâ€, label: â€œPatternsâ€, ico: â€œâ—«â€ },
{ id: â€œperspectiveâ€, label: â€œShiftâ€, ico: â€œâ—‡â€ },
{ id: â€œpartnerâ€, label: â€œPartnerâ€, ico: â€œâ™¡â€ },
{ id: â€œbenchmarkâ€, label: â€œBenchâ€, ico: â€œâ–³â€ },
];
return (
<nav style={css.nav}>
{items.map(i => (
<button key={i.id} onClick={() => go(i.id)} style={{ â€¦css.navBtn, color: view === i.id ? P.warm : P.dim, borderBottom: view === i.id ? `2px solid ${P.warm}` : â€œ2px solid transparentâ€ }}>
<span style={{ fontSize: 15 }}>{i.ico}</span>
<span style={{ fontSize: 10 }}>{i.label}</span>
</button>
))}
</nav>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  HOME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Home({ entries, profile, snaps, openEntry, openSnap, openCard }) {
const today = new Date().toISOString().slice(0, 10);
const todayN = entries.filter(e => e.date.slice(0, 10) === today).length;
const week = entries.filter(e => daysAgo(e.date) <= 7);
const weekPos = week.filter(e => e.response === â€œpositiveâ€ || e.response === â€œneutralâ€).length;
const days = profile?.startDate ? daysAgo(profile.startDate) : 0;
const lastSnap = snaps.length ? snaps[snaps.length - 1] : null;
const snapDue = !lastSnap || daysAgo(lastSnap.date) >= 28;

// Daily quote - deterministic based on day number since epoch
const dayNum = Math.floor(Date.now() / 86400000);
const dailyQuote = DAILY_QUOTES[dayNum % DAILY_QUOTES.length];

return (
<div>
{/* Daily quote */}
<div style={{ â€¦css.card, padding: 20, marginBottom: 12, borderLeft: `3px solid ${P.warm}44`, background: `linear-gradient(135deg, ${P.card} 0%, #1a1520 100%)` }}>
<p style={{ color: P.text, fontSize: 14, lineHeight: 1.7, fontStyle: â€œitalicâ€, margin: 0 }}>â€{dailyQuote.q}â€</p>
<p style={{ color: P.warm, fontSize: 11, margin: â€œ10px 0 0â€, opacity: 0.8 }}>â€” {dailyQuote.who}</p>
</div>
{/* CTA card */}
<div style={{ â€¦css.card, background: `linear-gradient(135deg, ${P.card} 0%, ${P.card2} 100%)`, padding: 24, marginBottom: 12 }}>
<p style={{ color: P.muted, margin: â€œ0 0 14pxâ€, fontSize: 15 }}>
{todayN === 0 ? â€œHow did things go today?â€ : `${todayN} interaction${todayN > 1 ? "s" : ""} logged today.`}
</p>
<Btn onClick={() => openEntry()}>Log an Interaction</Btn>
</div>

```
  {/* Stats */}
  <div style={{ display: "flex", gap: 8, marginBottom: 12 }}>
    <Stat n={days} l="days tracking" />
    <Stat n={entries.length} l="total logged" />
    <Stat n={week.length > 0 ? Math.round((weekPos / week.length) * 100) + "%" : "â€”"} l="positive this wk" />
  </div>

  {/* Snapshot prompt */}
  {snapDue && (
    <button onClick={openSnap} style={css.prompt}>
      <span style={{ fontSize: 16 }}>ğŸ“Š</span>
      <div style={{ flex: 1 }}>
        <div style={{ color: P.text, fontSize: 14, fontWeight: 500 }}>Monthly check-in {lastSnap ? "due" : "available"}</div>
        <div style={{ color: P.dim, fontSize: 12, marginTop: 2 }}>
          {lastSnap ? `Last snapshot was ${daysAgo(lastSnap.date)} days ago.` : "Take your first snapshot to start tracking progress."} Compare where things stand over time.
        </div>
      </div>
    </button>
  )}

  {/* Perspective shortcut */}
  <button onClick={openCard} style={{ ...css.prompt, borderColor: "#29232e" }}>
    <span style={{ fontSize: 16 }}>â—‡</span>
    <div style={{ flex: 1 }}>
      <div style={{ color: P.text, fontSize: 14, fontWeight: 500 }}>Need a perspective shift?</div>
      <div style={{ color: P.dim, fontSize: 12, marginTop: 2 }}>Research-backed reframes for when things feel heavy.</div>
    </div>
  </button>

  {/* Recent */}
  {entries.length > 0 && <SectionTitle>Recent</SectionTitle>}
  {entries.slice(0, 5).map(e => <EntryRow key={e.id} entry={e} onClick={() => openEntry(e)} />)}
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TIMELINE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Timeline({ entries, snaps, range, setRange, openEntry }) {
const ranges = { â€œ1mâ€: 30, â€œ3mâ€: 90, â€œ6mâ€: 180, â€œ1yâ€: 365, all: 99999 };
const cut = Date.now() - ranges[range] * 86400000;
const fil = useMemo(() =>
entries.filter(e => new Date(e.date).getTime() >= cut).sort((a, b) => new Date(a.date) - new Date(b.date)),
[entries, cut]
);

// Group by calendar date string (YYYY-MM-DD in local time)
const groups = useMemo(() => {
const m = {};
fil.forEach(e => {
const d = new Date(e.date);
const k = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}-${String(d.getDate()).padStart(2, "0")}`;
if (!m[k]) m[k] = [];
m[k].push(e);
});
return Object.entries(m).sort(([a], [b]) => a.localeCompare(b)).map(([k, v]) => ({ key: k, entries: v }));
}, [fil]);

const scores = groups.map(g => {
const s = g.entries.map(e => RESPONSES.find(r => r.id === e.response)?.score ?? 2);
return { â€¦g, avg: s.reduce((a, b) => a + b, 0) / s.length, count: g.entries.length };
});

// Small multiples: per response type, daily count over time
const [seriesFilter, setSeriesFilter] = useState(â€œallâ€);
const seriesData = useMemo(() => {
const allDates = groups.map(g => g.key);
return RESPONSES.map(r => {
const counts = groups.map(g => g.entries.filter(e => e.response === r.id).length);
return { â€¦r, counts, dates: allDates };
});
}, [groups]);

// Simple moving average trendline (window=3)
const trend = (arr) => {
if (arr.length < 3) return arr;
return arr.map((_, i) => {
const start = Math.max(0, i - 1);
const end = Math.min(arr.length, i + 2);
const slice = arr.slice(start, end);
return slice.reduce((a, b) => a + b, 0) / slice.length;
});
};

const fmtKey = (k) => {
const [y, m, d] = k.split(â€-â€);
const months = [â€œJanâ€,â€œFebâ€,â€œMarâ€,â€œAprâ€,â€œMayâ€,â€œJunâ€,â€œJulâ€,â€œAugâ€,â€œSepâ€,â€œOctâ€,â€œNovâ€,â€œDecâ€];
return `${months[parseInt(m) - 1]} ${parseInt(d)}`;
};

// SVG small multiple chart
const SmallMultiple = ({ data, maxY }) => {
const w = 280, h = 50, padL = 0, padR = 4;
const n = data.counts.length;
if (n === 0) return null;
const cMax = Math.max(maxY, 1);
const xStep = n > 1 ? (w - padL - padR) / (n - 1) : 0;

```
const points = data.counts.map((c, i) => ({ x: padL + i * xStep, y: h - (c / cMax) * (h - 4) }));
const trendVals = trend(data.counts);
const trendPts = trendVals.map((c, i) => ({ x: padL + i * xStep, y: h - (c / cMax) * (h - 4) }));

const pathD = points.map((p, i) => `${i === 0 ? "M" : "L"}${p.x},${p.y}`).join(" ");
const trendD = trendPts.map((p, i) => `${i === 0 ? "M" : "L"}${p.x},${p.y}`).join(" ");

return (
  <svg viewBox={`0 0 ${w} ${h}`} style={{ width: "100%", height: h, display: "block" }}>
    {/* Grid line at 0 */}
    <line x1={padL} y1={h} x2={w - padR} y2={h} stroke={P.border} strokeWidth="0.5" />
    {/* Data line */}
    {n > 1 ? (
      <>
        <path d={pathD} fill="none" stroke={data.c} strokeWidth="1.5" opacity="0.4" />
        <path d={trendD} fill="none" stroke={data.c} strokeWidth="2" />
      </>
    ) : (
      <circle cx={points[0].x} cy={points[0].y} r="3" fill={data.c} />
    )}
    {/* Dots */}
    {points.map((p, i) => <circle key={i} cx={p.x} cy={p.y} r="2" fill={data.c} opacity="0.6" />)}
  </svg>
);
```

};

const globalMaxDaily = useMemo(() => {
let mx = 0;
groups.forEach(g => {
RESPONSES.forEach(r => {
const c = g.entries.filter(e => e.response === r.id).length;
if (c > mx) mx = c;
});
});
return mx;
}, [groups]);

const filteredSeries = seriesFilter === â€œallâ€ ? seriesData : seriesData.filter(s => s.id === seriesFilter);

return (
<div>
<Tabs items={Object.keys(ranges).map(r => r === â€œallâ€ ? â€œAllâ€ : r)} active={range === â€œallâ€ ? â€œAllâ€ : range} onPick={(v) => setRange(v === â€œAllâ€ ? â€œallâ€ : v)} />

```
  {fil.length === 0 ? (
    <div style={{ textAlign: "center", padding: "48px 20px" }}>
      <p style={{ color: P.dim }}>No entries in this range yet.</p>
    </div>
  ) : (
    <>
      {/* Daily tone bar chart */}
      <div style={{ ...css.card, padding: 16, marginBottom: 12 }}>
        <p style={{ color: P.dim, fontSize: 12, margin: "0 0 10px" }}>Daily emotional tone (taller = more positive)</p>
        <div style={{ display: "flex", gap: 2, alignItems: "flex-end", height: 80 }}>
          {scores.map((g, i) => {
            const hPx = Math.max(Math.round((g.avg / 4) * 70), 4);
            const c = g.avg >= 3 ? P.green : g.avg >= 2 ? P.blue : g.avg >= 1 ? P.rose : P.red;
            return (
              <div key={i} style={{ flex: 1, maxWidth: 28 }}>
                <div style={{ width: "100%", height: hPx, background: c, borderRadius: "3px 3px 0 0" }} />
              </div>
            );
          })}
        </div>
        <div style={{ display: "flex", gap: 10, marginTop: 10, flexWrap: "wrap" }}>
          <span style={{ fontSize: 10, color: P.red }}>â— Very hard</span>
          <span style={{ fontSize: 10, color: P.rose }}>â— Difficult</span>
          <span style={{ fontSize: 10, color: P.blue }}>â— Mixed</span>
          <span style={{ fontSize: 10, color: P.green }}>â— Positive</span>
        </div>
      </div>

      {/* Small multiples time series */}
      {groups.length >= 2 && (
        <div style={{ ...css.card, padding: 16, marginBottom: 12 }}>
          <p style={{ color: P.dim, fontSize: 12, margin: "0 0 8px" }}>Response frequency over time (bold line = trend)</p>
          {/* Filter */}
          <div style={{ display: "flex", gap: 4, marginBottom: 12, flexWrap: "wrap" }}>
            <button onClick={() => setSeriesFilter("all")} style={{ ...css_chip(seriesFilter === "all", P.warm) }}>All</button>
            {RESPONSES.map(r => (
              <button key={r.id} onClick={() => setSeriesFilter(r.id)} style={{ ...css_chip(seriesFilter === r.id, r.c) }}>{r.icon} {r.label}</button>
            ))}
          </div>
          {filteredSeries.map(s => {
            const hasData = s.counts.some(c => c > 0);
            if (!hasData) return null;
            return (
              <div key={s.id} style={{ marginBottom: 10 }}>
                <div style={{ display: "flex", alignItems: "center", gap: 6, marginBottom: 2 }}>
                  <span style={{ fontSize: 12, color: s.c }}>{s.icon}</span>
                  <span style={{ fontSize: 11, color: s.c, fontWeight: 500 }}>{s.label}</span>
                  <span style={{ fontSize: 10, color: P.dim }}>({s.counts.reduce((a, b) => a + b, 0)} total)</span>
                </div>
                <SmallMultiple data={s} maxY={globalMaxDaily} />
              </div>
            );
          })}
          {/* X axis labels */}
          <div style={{ display: "flex", justifyContent: "space-between", marginTop: 2 }}>
            <span style={{ color: P.dimmer, fontSize: 9 }}>{fmtKey(groups[0].key)}</span>
            {groups.length > 2 && <span style={{ color: P.dimmer, fontSize: 9 }}>{fmtKey(groups[Math.floor(groups.length / 2)].key)}</span>}
            <span style={{ color: P.dimmer, fontSize: 9 }}>{fmtKey(groups[groups.length - 1].key)}</span>
          </div>
        </div>
      )}

      {/* Stats */}
      <div style={{ display: "flex", gap: 8, marginBottom: 12 }}>
        <Stat n={fil.length} l="interactions" />
        <Stat n={fil.filter(e => e.response === "positive" || e.response === "neutral").length} l="positive / neutral" />
        <Stat n={fil.filter(e => e.response === "rejection" || e.response === "escalation").length} l="rejections" />
      </div>

      {/* Entries with snapshot markers interleaved */}
      {(() => {
        const snapsByDate = {};
        snaps.forEach(s => {
          const d = new Date(s.date);
          const k = `${d.getFullYear()}-${String(d.getMonth() + 1).padStart(2, "0")}-${String(d.getDate()).padStart(2, "0")}`;
          snapsByDate[k] = s;
        });
        const items = fil.slice(0, 60).map(e => ({ type: "entry", data: e, date: new Date(e.date) }));
        // Insert snap markers
        snaps.forEach(s => {
          const sd = new Date(s.date);
          if (sd.getTime() >= cut) items.push({ type: "snap", data: s, date: sd });
        });
        items.sort((a, b) => b.date - a.date);
        return items.map((item, i) => {
          if (item.type === "entry") return <EntryRow key={item.data.id} entry={item.data} onClick={() => openEntry(item.data)} />;
          return (
            <div key={"snap-" + item.data.id} style={{ display: "flex", alignItems: "center", gap: 8, padding: "8px 12px", margin: "4px 0", borderLeft: `3px solid ${P.purple}`, background: P.card2, borderRadius: "0 8px 8px 0" }}>
              <span style={{ fontSize: 13 }}>ğŸ“Š</span>
              <div style={{ flex: 1 }}>
                <span style={{ color: P.purple, fontSize: 11, fontWeight: 500 }}>Progress snapshot</span>
                <span style={{ color: P.dim, fontSize: 10, marginLeft: 6 }}>{fmtShort(item.data.date)}</span>
              </div>
            </div>
          );
        });
      })()}
      {fil.length > 60 && <p style={{ color: P.dim, fontSize: 12, textAlign: "center", padding: 12 }}>Showing 60 of {fil.length}</p>}
    </>
  )}
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PATTERNS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Patterns({ entries, mode, setMode }) {
const aPats = useMemo(() => {
const m = {};
ACTIONS.forEach(a => { m[a.id] = { total: 0 }; RESPONSES.forEach(r => { m[a.id][r.id] = 0; }); });
entries.forEach(e => { if (m[e.action]) { m[e.action].total++; m[e.action][e.response]++; } });
return m;
}, [entries]);

const cPats = useMemo(() => {
const m = {};
entries.forEach(e => {
(e.contexts || []).forEach(c => {
if (!m[c]) { m[c] = { total: 0 }; RESPONSES.forEach(r => { m[c][r.id] = 0; }); }
m[c].total++; m[c][e.response]++;
});
});
return m;
}, [entries]);

const ranked = ACTIONS.map(a => {
const p = aPats[a.id]; if (p.total < 3) return null;
const pos = ((p.positive + p.neutral) / p.total) * 100;
return { â€¦a, pos, total: p.total };
}).filter(Boolean).sort((a, b) => b.pos - a.pos);

if (entries.length < 10) return (
<div style={{ textAlign: â€œcenterâ€, padding: â€œ48px 16pxâ€ }}>
<p style={{ color: P.text, fontSize: 16, marginBottom: 8 }}>Building your patternsâ€¦</p>
<p style={{ color: P.dim, fontSize: 14 }}>Log at least 10 interactions to start seeing patterns. You have {entries.length}.</p>
<div style={{ margin: â€œ20px autoâ€, maxWidth: 240 }}>
<div style={{ height: 6, background: P.border, borderRadius: 3, overflow: â€œhiddenâ€ }}>
<div style={{ height: â€œ100%â€, width: `${(entries.length / 10) * 100}%`, background: `linear-gradient(90deg, ${P.warm}, ${P.green})`, borderRadius: 3 }} />
</div>
<p style={{ color: P.dim, fontSize: 11, marginTop: 6 }}>{entries.length}/10</p>
</div>
</div>
);

return (
<div>
<Tabs items={[â€œBy Actionâ€, â€œBy Contextâ€, â€œInsightsâ€]} active={mode === â€œactionâ€ ? â€œBy Actionâ€ : mode === â€œcontextâ€ ? â€œBy Contextâ€ : â€œInsightsâ€} onPick={v => setMode(v === â€œBy Actionâ€ ? â€œactionâ€ : v === â€œBy Contextâ€ ? â€œcontextâ€ : â€œinsightsâ€)} />

```
  {mode === "action" && (
    <div>
      <p style={{ color: P.dim, fontSize: 13, marginBottom: 14 }}>How your stepchild responds to each type of action.</p>
      {/* Legend */}
      <div style={{ display: "flex", gap: 8, marginBottom: 12, flexWrap: "wrap" }}>
        {[...RESPONSES].reverse().map(r => <span key={r.id} style={{ fontSize: 10, color: r.c }}>{r.icon} {r.label}</span>)}
      </div>
      {ACTIONS.map(a => {
        const p = aPats[a.id]; if (p.total === 0) return null;
        const reversed = [...RESPONSES].reverse();
        return (
          <div key={a.id} style={{ ...css.card, padding: 14, marginBottom: 8 }}>
            <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 8 }}>
              <span style={{ color: a.c, fontSize: 13 }}>{a.icon} {a.label}</span>
              <span style={{ color: P.dim, fontSize: 11 }}>{p.total} logged</span>
            </div>
            <div style={{ display: "flex", height: 20, borderRadius: 5, overflow: "hidden" }}>
              {reversed.map(r => {
                const pct = (p[r.id] / p.total) * 100;
                if (pct === 0) return null;
                return <div key={r.id} style={{ width: `${pct}%`, background: r.c + "88", display: "flex", alignItems: "center", justifyContent: "center" }}>
                  {pct > 18 && <span style={{ fontSize: 9, color: "#fff" }}>{Math.round(pct)}%</span>}
                </div>;
              })}
            </div>
            <div style={{ display: "flex", gap: 8, marginTop: 6, flexWrap: "wrap" }}>
              {reversed.map(r => { const pct = (p[r.id] / p.total) * 100; if (pct === 0) return null; return <span key={r.id} style={{ color: r.c, fontSize: 10 }}>{r.icon} {Math.round(pct)}%</span>; })}
            </div>
          </div>
        );
      })}
    </div>
  )}

  {mode === "context" && (
    <div>
      <p style={{ color: P.dim, fontSize: 13, marginBottom: 14 }}>Which contexts produce which responses.</p>
      {Object.entries(cPats).filter(([, v]) => v.total >= 2).sort(([, a], [, b]) => b.total - a.total).map(([ctx, data]) => (
        <div key={ctx} style={{ ...css.card, padding: 14, marginBottom: 8 }}>
          <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 8 }}>
            <span style={{ color: P.text, fontSize: 13 }}>{ctx}</span>
            <span style={{ color: P.dim, fontSize: 11 }}>{data.total}Ã—</span>
          </div>
          <div style={{ display: "flex", height: 16, borderRadius: 5, overflow: "hidden" }}>
            {[...RESPONSES].reverse().map(r => { const pct = (data[r.id] / data.total) * 100; if (pct === 0) return null; return <div key={r.id} style={{ width: `${pct}%`, background: r.c + "88" }} />; })}
          </div>
        </div>
      ))}
      {Object.keys(cPats).filter(k => cPats[k].total >= 2).length === 0 && <p style={{ color: P.dim, fontSize: 13 }}>Tag contexts on entries to see patterns here.</p>}
    </div>
  )}

  {mode === "insights" && (
    <div>
      {ranked.length > 0 && (
        <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
          <div style={{ color: P.green, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>ğŸŒ± Most effective approach</div>
          <p style={{ color: P.text, fontSize: 14, margin: 0, lineHeight: 1.6 }}>
            <strong>{ranked[0].icon} {ranked[0].label}</strong> produces a positive or neutral response {Math.round(ranked[0].pos)}% of the time ({ranked[0].total} interactions).
          </p>
        </div>
      )}
      {ranked.length > 1 && ranked[ranked.length - 1].pos < 40 && (
        <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
          <div style={{ color: P.rose, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>âš¡ Most friction</div>
          <p style={{ color: P.text, fontSize: 14, margin: 0, lineHeight: 1.6 }}>
            <strong>{ranked[ranked.length - 1].icon} {ranked[ranked.length - 1].label}</strong> tends to produce more resistance ({Math.round(100 - ranked[ranked.length - 1].pos)}% negative).
          </p>
        </div>
      )}
      {entries.length >= 20 && (() => {
        const h = Math.floor(entries.length / 2);
        const rAvg = entries.slice(0, h).reduce((s, e) => s + (RESPONSES.find(r => r.id === e.response)?.score ?? 2), 0) / h;
        const oAvg = entries.slice(h).reduce((s, e) => s + (RESPONSES.find(r => r.id === e.response)?.score ?? 2), 0) / (entries.length - h);
        const d = rAvg - oAvg;
        return (
          <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
            <div style={{ color: d > 0.3 ? P.green : d < -0.3 ? P.rose : P.blue, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>
              {d > 0.3 ? "ğŸ“ˆ Positive trend" : d < -0.3 ? "ğŸ“‰ Difficult stretch" : "â” Steady state"}
            </div>
            <p style={{ color: P.text, fontSize: 14, margin: 0, lineHeight: 1.6 }}>
              {d > 0.3 ? "Recent interactions are trending more positively. Keep going â€” this is real progress."
               : d < -0.3 ? "Recent interactions have been harder. This is normal â€” stepfamily relationships aren't linear. A difficult stretch doesn't erase progress."
               : "Responses have been consistent. In stepfamily dynamics, stability is itself a form of progress."}
            </p>
          </div>
        );
      })()}
      {entries.length < 20 && (
        <div style={{ ...css.card, padding: 16 }}>
          <div style={{ color: P.blue, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>ğŸ“Š More data needed</div>
          <p style={{ color: P.muted, fontSize: 13, margin: 0 }}>Trend analysis needs ~20 entries. You have {entries.length}.</p>
        </div>
      )}
    </div>
  )}
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PERSPECTIVE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Perspective({ entries, openCard }) {
return (
<div>
<p style={{ color: P.muted, fontSize: 14, marginBottom: 16 }}>
Research-backed reframes. Not platitudes â€” real perspectives from research and adult stepchildren looking back.
</p>
{CARDS.map((c, i) => (
<button key={i} onClick={() => openCard(c)} style={{ â€¦css.card, padding: 16, marginBottom: 8, width: â€œ100%â€, textAlign: â€œleftâ€, cursor: â€œpointerâ€, border: `1px solid ${P.border}`, fontFamily: â€œinheritâ€ }}>
<div style={{ color: P.text, fontWeight: 500, marginBottom: 4, fontSize: 14 }}>{c.title}</div>
<div style={{ color: P.dim, fontSize: 13, lineHeight: 1.5 }}>{c.body.slice(0, 110)}â€¦</div>
{c.quote && <div style={{ color: P.warm, fontSize: 11, marginTop: 6, fontStyle: â€œitalicâ€ }}>Includes firsthand account â—‡</div>}
</button>
))}
</div>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  PARTNER â€” Communication Tips & Share
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Partner({ entries, profile, snaps }) {
const [tab, setTab] = useState(â€œtipsâ€);
const [expandedTip, setExpandedTip] = useState(null);
const [copied, setCopied] = useState(false);

const generateReport = () => {
const month = entries.filter(e => daysAgo(e.date) <= 30);
if (month.length === 0) return null;
const total = month.length;
const pos = month.filter(e => e.response === â€œpositiveâ€ || e.response === â€œneutralâ€).length;
const rej = month.filter(e => e.response === â€œrejectionâ€ || e.response === â€œescalationâ€).length;
const pct = Math.round((pos / total) * 100);
const actionCounts = {};
ACTIONS.forEach(a => { actionCounts[a.id] = { pos: 0, total: 0 }; });
month.forEach(e => {
if (actionCounts[e.action]) {
actionCounts[e.action].total++;
if (e.response === â€œpositiveâ€ || e.response === â€œneutralâ€) actionCounts[e.action].pos++;
}
});
let bestAction = null, bestPct = 0;
Object.entries(actionCounts).forEach(([id, d]) => {
if (d.total >= 3) {
const p = d.pos / d.total;
if (p > bestPct) { bestPct = p; bestAction = ACTIONS.find(a => a.id === id); }
}
});
const lines = [
â€œMonthly Update from Steadfastâ€,
String.fromCharCode(9472).repeat(29),
â€œâ€,
`This month, I logged ${total} interactions with your child.`,
â€œâ€,
`${pct}% of responses were positive or neutral.`,
`${rej} interactions involved active rejection or escalation.`,
â€œâ€,
];
if (bestAction) {
lines.push(`What seems to work best: "${bestAction.label}" \u2014 ${Math.round(bestPct * 100)}% positive response rate.`);
lines.push(â€â€);
}
lines.push(â€œWhat I need from you:â€);
lines.push(â€\u2022 Acknowledge what you see me doing, even small thingsâ€);
lines.push(â€\u2022 Back me up in the moment, even with just a wordâ€);
lines.push(â€\u2022 Remind me that my effort matters when I canâ€™t see itâ€);
lines.push(â€â€);
lines.push(â€œThis isnâ€™t a complaint. Itâ€™s me showing you what Iâ€™m tracking so we can be a team in this.â€);
lines.push(â€â€);
lines.push(â€\u2014 Sent from Steadfastâ€);
return lines.join(â€\nâ€);
};

const report = generateReport();

const copyReport = () => {
if (!report) return;
navigator.clipboard.writeText(report).then(() => {
setCopied(true); setTimeout(() => setCopied(false), 2000);
}).catch(() => {
const ta = document.createElement(â€œtextareaâ€);
ta.value = report; document.body.appendChild(ta); ta.select();
document.execCommand(â€œcopyâ€); document.body.removeChild(ta);
setCopied(true); setTimeout(() => setCopied(false), 2000);
});
};

return (
<div>
<Tabs items={[â€œTipsâ€, â€œShareâ€, â€œAlienationâ€]} active={tab === â€œtipsâ€ ? â€œTipsâ€ : tab === â€œshareâ€ ? â€œShareâ€ : â€œAlienationâ€} onPick={v => setTab(v === â€œTipsâ€ ? â€œtipsâ€ : v === â€œShareâ€ ? â€œshareâ€ : â€œalienationâ€)} />

```
  {tab === "tips" && (
    <div>
      <p style={{ color: P.muted, fontSize: 14, marginBottom: 16, lineHeight: 1.6 }}>
        How to talk to your partner about what you're going through â€” without it turning into a fight.
      </p>
      {PARTNER_TIPS.map((t, i) => (
        <button key={i} onClick={() => setExpandedTip(expandedTip === i ? null : i)} style={{ ...css.card, padding: 16, marginBottom: 8, width: "100%", textAlign: "left", cursor: "pointer", border: `1px solid ${expandedTip === i ? P.warm + "44" : P.border}`, fontFamily: "inherit" }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
            <div style={{ color: P.text, fontWeight: 500, fontSize: 14 }}>{t.title}</div>
            <span style={{ color: P.dim, fontSize: 12, transform: expandedTip === i ? "rotate(180deg)" : "none", transition: "transform .2s" }}>{"\u25BE"}</span>
          </div>
          <div style={{ color: P.dim, fontSize: 12, marginTop: 4 }}>{t.situation}</div>
          {expandedTip === i && (
            <div style={{ marginTop: 12 }}>
              <div style={{ padding: 14, background: P.bg, borderRadius: 10, borderLeft: `3px solid ${P.green}44`, marginBottom: 10 }}>
                <p style={{ color: P.dim, fontSize: 10, margin: "0 0 6px", textTransform: "uppercase", letterSpacing: "0.05em" }}>Try saying</p>
                <p style={{ color: P.text, fontSize: 13, margin: 0, lineHeight: 1.6, fontStyle: "italic" }}>{t.tip}</p>
              </div>
              <div style={{ padding: 14, background: P.bg, borderRadius: 10, borderLeft: `3px solid ${P.blue}44` }}>
                <p style={{ color: P.dim, fontSize: 10, margin: "0 0 6px", textTransform: "uppercase", letterSpacing: "0.05em" }}>Why this works</p>
                <p style={{ color: P.muted, fontSize: 13, margin: 0, lineHeight: 1.6 }}>{t.why}</p>
              </div>
            </div>
          )}
        </button>
      ))}
    </div>
  )}

  {tab === "share" && (
    <div>
      <p style={{ color: P.muted, fontSize: 14, marginBottom: 16, lineHeight: 1.6 }}>
        Share a monthly summary with your partner. It shows what you've been doing, what's working, and what you need â€” backed by data, not just feelings.
      </p>
      {report ? (
        <div>
          <div style={{ ...css.card, padding: 16, marginBottom: 12 }}>
            <pre style={{ color: P.muted, fontSize: 11, lineHeight: 1.6, margin: 0, whiteSpace: "pre-wrap", wordBreak: "break-word", fontFamily: "inherit" }}>{report}</pre>
          </div>
          <Btn onClick={copyReport} full>{copied ? "Copied!" : "Copy to clipboard"}</Btn>
          <p style={{ color: P.dim, fontSize: 11, marginTop: 10, textAlign: "center" }}>Paste into a message, email, or note to share with your partner.</p>
        </div>
      ) : (
        <div style={{ textAlign: "center", padding: "40px 20px" }}>
          <p style={{ color: P.dim, fontSize: 14 }}>Log some interactions first to generate a report.</p>
        </div>
      )}
    </div>
  )}

  {tab === "alienation" && (
    <div>
      <div style={{ ...css.card, padding: 20, marginBottom: 12, borderLeft: `3px solid ${P.rose}` }}>
        <h3 style={{ color: P.text, fontSize: 16, fontFamily: "Georgia, 'Times New Roman', serif", margin: "0 0 10px" }}>{ALIENATION.title}</h3>
        <p style={{ color: P.muted, fontSize: 13, lineHeight: 1.7, margin: 0 }}>{ALIENATION.intro}</p>
      </div>
      <div style={{ ...css.card, padding: 16, marginBottom: 12 }}>
        <div style={{ color: P.rose, fontSize: 13, fontWeight: 500, marginBottom: 10 }}>Warning signs</div>
        {ALIENATION.signs.map((s, i) => (
          <div key={i} style={{ display: "flex", gap: 8, marginBottom: 8 }}>
            <span style={{ color: P.rose, fontSize: 11, marginTop: 2, flexShrink: 0 }}>{"\u2022"}</span>
            <p style={{ color: P.muted, fontSize: 13, margin: 0, lineHeight: 1.5 }}>{s}</p>
          </div>
        ))}
      </div>
      {ALIENATION.guidance.map((g, i) => (
        <div key={i} style={{ ...css.card, padding: 16, marginBottom: 8 }}>
          <div style={{ color: P.text, fontSize: 14, fontWeight: 500, marginBottom: 6 }}>{g.title}</div>
          <p style={{ color: P.muted, fontSize: 13, lineHeight: 1.6, margin: 0 }}>{g.text}</p>
        </div>
      ))}
      <div style={{ ...css.card, padding: 16, marginTop: 4, background: `${P.card2}88`, borderLeft: `3px solid ${P.blue}44` }}>
        <p style={{ color: P.dim, fontSize: 12, margin: 0, lineHeight: 1.6 }}>{ALIENATION.note}</p>
      </div>
    </div>
  )}
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BENCHMARK
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Benchmark({ profile, snaps, entries, openSnap, onDeleteSnap }) {
if (!profile) return null;
const age = BENCH.ages[profile.childAge];
const cust = BENCH.custody[profile.custody];
const loy = BENCH.loyalty[profile.loyaltyConflict];

return (
<div>
<SectionTitle>Your Situation</SectionTitle>
<div style={{ display: â€œgridâ€, gridTemplateColumns: â€œ1fr 1frâ€, gap: 8, marginBottom: 16 }}>
<BenchItem label=â€œChildâ€™s ageâ€ value={profile.childAge + â€œ yrsâ€} />
<BenchItem label="Custody" value={profile.custody} />
<BenchItem label="Loyalty conflict" value={profile.loyaltyConflict} />
<BenchItem label=â€œTime in roleâ€ value={profile.yearsInRole + â€œ yrâ€ + (profile.yearsInRole !== â€œ1â€ ? â€œsâ€ : â€œâ€)} />
</div>

```
  {age && (
    <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
      <div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>Typical integration timeline</div>
      <div style={{ color: P.text, fontSize: 20, fontFamily: "Georgia, 'Times New Roman', serif", fontWeight: 500, marginBottom: 8 }}>{age.t}</div>
      <p style={{ color: P.muted, fontSize: 13, margin: 0, lineHeight: 1.6 }}>{age.note}</p>
      <div style={{ marginTop: 12, padding: 12, background: P.bg, borderRadius: 8 }}>
        <p style={{ color: P.blue, fontSize: 12, margin: 0 }}>
          You're ~{profile.yearsInRole} year{profile.yearsInRole !== "1" ? "s" : ""} in.
          {parseInt(profile.yearsInRole) < 4 ? " Still early â€” fastest documented full integration was 4 years." : ""}
          {parseInt(profile.yearsInRole) >= 7 ? " Your sustained presence matters, regardless of where the relationship has settled." : ""}
        </p>
      </div>
    </div>
  )}

  {cust && <div style={{ ...css.card, padding: 16, marginBottom: 10 }}><div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>Custody impact</div><p style={{ color: P.muted, fontSize: 13, margin: 0, lineHeight: 1.6 }}>{cust}</p></div>}
  {loy && <div style={{ ...css.card, padding: 16, marginBottom: 10 }}><div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 6 }}>Loyalty dynamics</div><p style={{ color: P.muted, fontSize: 13, margin: 0, lineHeight: 1.6 }}>{loy}</p></div>}

  {/* Outcomes */}
  <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
    <div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 10 }}>Realistic outcome spectrum</div>
    <p style={{ color: P.dim, fontSize: 12, marginBottom: 10 }}>All of these are valid success states.</p>
    {BENCH.outcomes.map((o, i) => (
      <div key={i} style={{ padding: "10px 12px", borderLeft: `3px solid ${o.c}`, marginBottom: 6, background: P.bg, borderRadius: "0 8px 8px 0" }}>
        <div style={{ display: "flex", justifyContent: "space-between" }}>
          <span style={{ color: P.text, fontSize: 13, fontWeight: 500 }}>{o.l}</span>
          <span style={{ color: P.dim, fontSize: 11 }}>{o.p}</span>
        </div>
        <p style={{ color: P.dim, fontSize: 12, margin: "3px 0 0" }}>{o.d}</p>
      </div>
    ))}
  </div>

  {/* First vs Latest summary */}
  {snaps.length >= 2 && (() => {
    const first = snaps[0];
    const last = snaps[snaps.length - 1];
    const improved = SNAP_Q.filter(q => (last.answers?.[q.id] ?? 0) > (first.answers?.[q.id] ?? 0)).length;
    const declined = SNAP_Q.filter(q => (last.answers?.[q.id] ?? 0) < (first.answers?.[q.id] ?? 0)).length;
    const same = SNAP_Q.length - improved - declined;
    const daysBetween = Math.round((new Date(last.date) - new Date(first.date)) / 86400000);
    return (
      <div style={{ ...css.card, padding: 18, marginBottom: 10, borderLeft: `3px solid ${improved > declined ? P.green : improved < declined ? P.rose : P.blue}` }}>
        <div style={{ color: P.text, fontSize: 15, fontFamily: "Georgia, 'Times New Roman', serif", fontWeight: 500, marginBottom: 8 }}>
          {improved > declined ? "Things are moving" : improved < declined ? "A harder stretch" : "Holding steady"}
        </div>
        <p style={{ color: P.muted, fontSize: 13, margin: "0 0 10px", lineHeight: 1.5 }}>
          Over {daysBetween} days and {snaps.length} snapshots:
        </p>
        <div style={{ display: "flex", gap: 12 }}>
          {improved > 0 && <div style={{ flex: 1, padding: 10, background: P.bg, borderRadius: 8, textAlign: "center" }}>
            <div style={{ color: P.green, fontSize: 20, fontWeight: 600 }}>{improved}</div>
            <div style={{ color: P.dim, fontSize: 10 }}>improved</div>
          </div>}
          {same > 0 && <div style={{ flex: 1, padding: 10, background: P.bg, borderRadius: 8, textAlign: "center" }}>
            <div style={{ color: P.blue, fontSize: 20, fontWeight: 600 }}>{same}</div>
            <div style={{ color: P.dim, fontSize: 10 }}>steady</div>
          </div>}
          {declined > 0 && <div style={{ flex: 1, padding: 10, background: P.bg, borderRadius: 8, textAlign: "center" }}>
            <div style={{ color: P.rose, fontSize: 20, fontWeight: 600 }}>{declined}</div>
            <div style={{ color: P.dim, fontSize: 10 }}>harder</div>
          </div>}
        </div>
      </div>
    );
  })()}

  {/* Snapshot trend charts â€” one per question */}
  {snaps.length >= 2 && (
    <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
      <div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 12 }}>Progress over time</div>
      {SNAP_Q.map(q => {
        const dataPoints = snaps.map(s => ({ val: s.answers?.[q.id] ?? null, date: s.date })).filter(d => d.val !== null);
        if (dataPoints.length < 2) return null;
        const vals = dataPoints.map(d => d.val);
        const max = q.s.length - 1;
        const first = vals[0];
        const latest = vals[vals.length - 1];
        const delta = latest - first;
        const deltaColor = delta > 0 ? P.green : delta < 0 ? P.red : P.dim;
        const w = 260, h = 50;
        const xStep = (w - 8) / (vals.length - 1);
        const pts = vals.map((v, i) => ({ x: 4 + i * xStep, y: h - 6 - (v / max) * (h - 12) }));
        const pathD = pts.map((p, i) => `${i === 0 ? "M" : "L"}${p.x},${p.y}`).join(" ");
        // Area fill
        const areaD = pathD + ` L${pts[pts.length - 1].x},${h - 6} L${pts[0].x},${h - 6} Z`;
        return (
          <div key={q.id} style={{ marginBottom: 16 }}>
            <div style={{ color: P.muted, fontSize: 12, marginBottom: 2, lineHeight: 1.4 }}>{q.q}</div>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 4 }}>
              <span style={{ color: P.dim, fontSize: 10 }}>{q.s[first]}</span>
              <span style={{ color: deltaColor, fontSize: 11, fontWeight: 500 }}>
                {delta > 0 ? "\u2192 " : delta < 0 ? "\u2192 " : ""}{q.s[latest]} {delta > 0 ? "\u2191" : delta < 0 ? "\u2193" : "="}
              </span>
            </div>
            <svg viewBox={`0 0 ${w} ${h}`} style={{ width: "100%", height: h, display: "block" }}>
              <line x1="4" y1={h - 6} x2={w - 4} y2={h - 6} stroke={P.border} strokeWidth="0.5" />
              <path d={areaD} fill={P.warm + "11"} />
              <path d={pathD} fill="none" stroke={P.warm} strokeWidth="2" />
              {pts.map((p, i) => (
                <g key={i}>
                  <circle cx={p.x} cy={p.y} r={i === 0 || i === pts.length - 1 ? 4 : 2.5} fill={i === pts.length - 1 ? P.warm : i === 0 ? P.dim : P.dim} />
                </g>
              ))}
            </svg>
            <div style={{ display: "flex", justifyContent: "space-between" }}>
              <span style={{ color: P.dimmer, fontSize: 8 }}>{fmtShort(dataPoints[0].date)}</span>
              <span style={{ color: P.dimmer, fontSize: 8 }}>{fmtShort(dataPoints[dataPoints.length - 1].date)}</span>
            </div>
          </div>
        );
      })}
    </div>
  )}

  {/* Individual snapshots â€” compact list */}
  {snaps.length > 0 && (
    <div style={{ ...css.card, padding: 16, marginBottom: 10 }}>
      <div style={{ color: P.warm, fontSize: 13, fontWeight: 500, marginBottom: 10 }}>All snapshots ({snaps.length})</div>
      {[...snaps].reverse().map(s => (
        <div key={s.id} style={{ padding: "8px 0", borderBottom: `1px solid ${P.border}`, display: "flex", justifyContent: "space-between", alignItems: "center" }}>
          <div>
            <span style={{ color: P.text, fontSize: 12 }}>{fmtDate(s.date)}</span>
            <span style={{ color: P.dim, fontSize: 10, marginLeft: 8 }}>
              {SNAP_Q.slice(0, 2).map(q => s.answers?.[q.id] !== undefined ? q.s[s.answers[q.id]] : "").filter(Boolean).join(" \u00B7 ")}
            </span>
          </div>
          <button onClick={() => onDeleteSnap(s.id)} style={{ background: "none", border: "none", color: P.dim, cursor: "pointer", fontSize: 11, padding: "4px 8px" }}>{"\u2715"}</button>
        </div>
      ))}
    </div>
  )}

  <Btn onClick={openSnap} full>Take a Progress Snapshot</Btn>
</div>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ENTRY MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function EntryModal({ entry, onSave, onDelete, onClose }) {
const isEdit = !!entry;
const [action, setAction] = useState(entry?.action || â€œâ€);
const [response, setResponse] = useState(entry?.response || â€œâ€);
const [note, setNote] = useState(entry?.note || â€œâ€);
const [ctxs, setCtxs] = useState(entry?.contexts || []);
const [date, setDate] = useState(entry?.date?.slice(0, 10) || new Date().toISOString().slice(0, 10));
const [confirmDel, setConfirmDel] = useState(false);
const [photo, setPhoto] = useState(entry?.photo || null);
const fileRef = useRef(null);

const toggle = (c) => setCtxs(p => p.includes(c) ? p.filter(x => x !== c) : [â€¦p, c]);
const valid = action && response;

const handlePhoto = (e) => {
const file = e.target.files[0];
if (!file) return;
// Resize to max 800px to keep IndexedDB manageable
const reader = new FileReader();
reader.onload = (ev) => {
const img = new Image();
img.onload = () => {
const max = 800;
let w = img.width, h = img.height;
if (w > max || h > max) {
if (w > h) { h = Math.round(h * max / w); w = max; }
else { w = Math.round(w * max / h); h = max; }
}
const canvas = document.createElement(â€œcanvasâ€);
canvas.width = w; canvas.height = h;
canvas.getContext(â€œ2dâ€).drawImage(img, 0, 0, w, h);
setPhoto(canvas.toDataURL(â€œimage/jpegâ€, 0.7));
};
img.src = ev.target.result;
};
reader.readAsDataURL(file);
};

return (
<Modal onClose={onClose} title={isEdit ? â€œEdit Interactionâ€ : â€œLog an Interactionâ€}>
<label style={css.label}>Date</label>
<input type=â€œdateâ€ value={date} onChange={e => setDate(e.target.value)} style={css.dateIn} />

```
  <label style={css.label}>What did you do?</label>
  <div style={css.chips}>
    {ACTIONS.map(a => <Chip key={a.id} active={action === a.id} color={a.c} onClick={() => setAction(a.id)}>{a.icon} {a.label}</Chip>)}
  </div>

  <label style={css.label}>How did they respond?</label>
  <div style={css.chips}>
    {RESPONSES.map(r => <Chip key={r.id} active={response === r.id} color={r.c} onClick={() => setResponse(r.id)}>{r.icon} {r.label}</Chip>)}
  </div>

  <label style={css.label}>Context <span style={{ color: P.dim, fontWeight: 400 }}>(optional)</span></label>
  <div style={css.chips}>
    {CONTEXTS.map(c => <Chip key={c} small active={ctxs.includes(c)} color={P.warm} onClick={() => toggle(c)}>{c}</Chip>)}
  </div>

  <label style={css.label}>Photo <span style={{ color: P.dim, fontWeight: 400 }}>(optional)</span></label>
  {photo ? (
    <div style={{ marginBottom: 14, position: "relative", display: "inline-block" }}>
      <img src={photo} alt="Attached" style={{ width: "100%", maxWidth: 220, borderRadius: 10, display: "block", border: `1px solid ${P.border}` }} />
      <button onClick={() => { setPhoto(null); if (fileRef.current) fileRef.current.value = ""; }} style={{ position: "absolute", top: 6, right: 6, background: "rgba(0,0,0,0.7)", border: "none", color: "#fff", borderRadius: "50%", width: 24, height: 24, fontSize: 13, cursor: "pointer", display: "flex", alignItems: "center", justifyContent: "center" }}>âœ•</button>
    </div>
  ) : (
    <button onClick={() => fileRef.current?.click()} style={{ display: "flex", alignItems: "center", gap: 8, padding: "10px 14px", borderRadius: 9, border: `1px dashed ${P.border2}`, background: "transparent", color: P.dim, cursor: "pointer", fontSize: 13, fontFamily: "inherit", marginBottom: 14, width: "100%" }}>
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="1.5"><rect x="3" y="3" width="18" height="18" rx="3"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
      Add a photo
    </button>
  )}
  <input ref={fileRef} type="file" accept="image/*" onChange={handlePhoto} style={{ display: "none" }} />

  <label style={css.label}>Notes <span style={{ color: P.dim, fontWeight: 400 }}>(optional)</span></label>
  <textarea value={note} onChange={e => setNote(e.target.value)} placeholder="What happened? How did it feel?" style={css.textarea} rows={3} />

  <Btn onClick={() => { if (valid) onSave({ id: entry?.id || uid(), date: new Date(date + "T12:00:00").toISOString(), action, response, note, contexts: ctxs, photo: photo || undefined }); }} full disabled={!valid} style={{ marginTop: 16 }}>{isEdit ? "Update" : "Save"}</Btn>

  {isEdit && onDelete && (
    !confirmDel
      ? <button onClick={() => setConfirmDel(true)} style={{ ...css.textBtn, color: P.dim, marginTop: 8 }}>Delete this entry</button>
      : <div style={{ textAlign: "center", marginTop: 8 }}>
          <p style={{ color: P.red, fontSize: 12, margin: "0 0 6px" }}>Are you sure?</p>
          <button onClick={() => onDelete(entry.id)} style={{ ...css.textBtn, color: P.red }}>Yes, delete</button>
          <button onClick={() => setConfirmDel(false)} style={{ ...css.textBtn, color: P.dim, marginLeft: 12 }}>Cancel</button>
        </div>
  )}
</Modal>
```

);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CARD (PERSPECTIVE) MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function CardModal({ card, onClose }) {
return (
<Modal onClose={onClose} title={`â—‡ ${card.title}`} titleColor={P.warm}>
<p style={{ color: â€œ#D1D5DBâ€, fontSize: 15, lineHeight: 1.7 }}>{card.body}</p>
{card.src && <p style={{ color: P.blue, fontSize: 12, fontStyle: â€œitalicâ€, marginTop: 12 }}>Source: {card.src}</p>}
{card.quote && (
<div style={{ background: P.bg, borderRadius: 12, padding: 16, marginTop: 16, borderLeft: `3px solid ${P.warm}44` }}>
<p style={{ color: P.text, fontSize: 14, lineHeight: 1.7, fontStyle: â€œitalicâ€, margin: 0 }}>{card.quote}</p>
{card.who && <p style={{ color: P.warm, fontSize: 12, marginTop: 8, marginBottom: 0 }}>â€” {card.who}</p>}
</div>
)}
<div style={{ marginTop: 20, padding: 14, background: `${P.card2}88`, borderRadius: 10, borderLeft: `3px solid ${P.green}33` }}>
<p style={{ color: P.dim, fontSize: 12, margin: 0, lineHeight: 1.6 }}>
This perspective isnâ€™t about dismissing your pain. What youâ€™re feeling is real. This is about separating whatâ€™s happening from what it means â€” because in stepfamily dynamics, those are often very different things.
</p>
</div>
</Modal>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SNAPSHOT MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function SnapModal({ snaps, onSave, onClose }) {
const [ans, setAns] = useState({});
const done = SNAP_Q.every(q => ans[q.id] !== undefined);

return (
<Modal onClose={onClose} title="Monthly Check-in">
<p style={{ color: P.dim, fontSize: 13, marginBottom: 16 }}>Answer honestly â€” this is for you. These snapshots become valuable when you compare them over time.</p>
{SNAP_Q.map(q => (
<div key={q.id} style={{ marginBottom: 18 }}>
<label style={{ â€¦css.label, fontSize: 13 }}>{q.q}</label>
<div style={css.chips}>
{q.s.map((s, i) => <Chip key={i} small active={ans[q.id] === i} color={P.warm} onClick={() => setAns(p => ({ â€¦p, [q.id]: i }))}>{s}</Chip>)}
</div>
</div>
))}
<Btn onClick={() => { if (done) onSave({ id: uid(), date: new Date().toISOString(), answers: ans }); }} full disabled={!done}>Save Snapshot</Btn>
</Modal>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SETTINGS MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function SettingsModal({ onClose, onExport, onImport, onRedo }) {
const ref = useRef(null);
const [showPrivacy, setShowPrivacy] = useState(false);
return (
<Modal onClose={onClose} title="Settings" small>
<p style={{ color: P.dim, fontSize: 13, marginBottom: 14 }}>Your data lives on this device only. Back it up to keep it safe.</p>
<Btn onClick={onExport} full>Export Data Backup</Btn>
<Btn onClick={() => ref.current?.click()} full secondary style={{ marginTop: 8 }}>Import Data Backup</Btn>
<input ref={ref} type=â€œfileâ€ accept=â€.jsonâ€ onChange={onImport} style={{ display: â€œnoneâ€ }} />
<hr style={{ border: â€œnoneâ€, borderTop: `1px solid ${P.border}`, margin: â€œ20px 0 14pxâ€ }} />
<Btn onClick={onRedo} full secondary>Redo Onboarding</Btn>
<hr style={{ border: â€œnoneâ€, borderTop: `1px solid ${P.border}`, margin: â€œ20px 0 14pxâ€ }} />
<button onClick={() => setShowPrivacy(p => !p)} style={{ â€¦css.textBtn, color: P.dim, width: â€œ100%â€, textAlign: â€œcenterâ€, fontSize: 12 }}>
{showPrivacy ? â€œHideâ€ : â€œShowâ€} Privacy Policy
</button>
{showPrivacy && (
<div style={{ marginTop: 10, padding: 14, background: P.bg, borderRadius: 10, fontSize: 11, color: P.muted, lineHeight: 1.7 }}>
<p style={{ fontWeight: 600, color: P.text, marginBottom: 8, fontSize: 12 }}>Privacy Policy</p>
<p style={{ margin: â€œ0 0 8pxâ€ }}>Steadfast stores all data locally on your device using IndexedDB. This includes interaction logs, profile settings, progress snapshots, and any photos you attach.</p>
<p style={{ margin: â€œ0 0 8pxâ€ }}><strong style={{ color: P.text }}>No data is collected, transmitted, or stored on any server.</strong> We have no access to your data. There is no account, no login, no analytics, no tracking, and no cookies.</p>
<p style={{ margin: â€œ0 0 8pxâ€ }}>No external network requests are made. The app uses only system fonts and runs entirely offline after first load.</p>
<p style={{ margin: â€œ0 0 8pxâ€ }}>You can export your data as a JSON file at any time using the Export button above. You can delete all data by clearing your browserâ€™s site data for this app.</p>
<p style={{ margin: â€œ0 0 8pxâ€ }}>Photos you attach are resized and stored locally as part of your entry data. They are never uploaded anywhere.</p>
<p style={{ margin: 0 }}>Contact: [your email here]</p>
</div>
)}
</Modal>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  ONBOARDING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Onboarding({ onDone }) {
const [step, setStep] = useState(0);
const [d, setD] = useState({ childAge: â€œâ€, custody: â€œâ€, loyaltyConflict: â€œâ€, yearsInRole: â€œâ€, currentState: â€œâ€, startDate: new Date().toISOString() });
const upd = (k, v) => setD(p => ({ â€¦p, [k]: v }));

const steps = [
{ title: â€œBefore we startâ€, sub: â€œThis needs to be said upfront.â€, content: (
<div>
<p style={css.obText}>The path to a functional relationship with a resistant stepchild typically takes <strong style={{ color: P.warm }}>7 to 12 years</strong>. The fastest documented full integration was 4 years. Some families never get there â€” and a stable, respectful distance is a valid outcome.</p>
<p style={css.obText}>No app will change that timeline. What this tool does is make the invisible visible â€” so you can see whether your efforts are producing change, even when it doesnâ€™t feel like it.</p>
<p style={css.obText}>Youâ€™re not here because you failed. Youâ€™re here because you care enough to track whatâ€™s actually happening.</p>
</div>
)},
{ title: â€œHow old is the child?â€, sub: â€œAt the time your family formedâ€, content: (
<div style={css.chips}>{Object.keys(BENCH.ages).map(a => <ObBtn key={a} active={d.childAge === a} onClick={() => upd(â€œchildAgeâ€, a)}>{a} years</ObBtn>)}</div>
)},
{ title: â€œCustody arrangementâ€, content: (
<div style={css.chips}>{[â€œfullâ€, â€œ50-50â€, â€œweekendsâ€, â€œotherâ€].map(c => <ObBtn key={c} active={d.custody === c} onClick={() => upd(â€œcustodyâ€, c)}>{c === â€œfullâ€ ? â€œFull-timeâ€ : c === â€œ50-50â€ ? â€œ50/50â€ : c === â€œweekendsâ€ ? â€œWeekendsâ€ : â€œOtherâ€}</ObBtn>)}</div>
)},
{ title: â€œLoyalty conflict?â€, sub: â€œDoes the child seem torn between accepting you and staying loyal to their biological parent?â€, content: (
<div style={css.chips}>{[â€œnoneâ€, â€œmildâ€, â€œstrongâ€, â€œunknownâ€].map(l => <ObBtn key={l} active={d.loyaltyConflict === l} onClick={() => upd(â€œloyaltyConflictâ€, l)}>{l === â€œnoneâ€ ? â€œNo visible conflictâ€ : l === â€œmildâ€ ? â€œSome tensionâ€ : l === â€œstrongâ€ ? â€œStrong / activeâ€ : â€œIâ€™m not sureâ€}</ObBtn>)}</div>
)},
{ title: â€œHow long in this role?â€, content: (
<div style={css.chips}>{[â€< 1â€, â€œ1â€, â€œ2-3â€, â€œ4-6â€, â€œ7+â€].map(y => <ObBtn key={y} active={d.yearsInRole === y} onClick={() => upd(â€œyearsInRoleâ€, y)}>{y} yr{y !== â€œ1â€ && y !== â€œ< 1â€ ? â€œsâ€ : â€œâ€}</ObBtn>)}</div>
)},
{ title: â€œCurrent relationship stateâ€, content: (
<div style={css.chips}>{[â€œhostileâ€, â€œavoidantâ€, â€œtenseâ€, â€œneutralâ€, â€œwarmingâ€].map(s => <ObBtn key={s} active={d.currentState === s} onClick={() => upd(â€œcurrentStateâ€, s)}>{s.charAt(0).toUpperCase() + s.slice(1)}</ObBtn>)}</div>
)},
{ title: â€œYour realistic benchmarkâ€, content: (() => {
const age = BENCH.ages[d.childAge];
return (
<div>
{age && <>
<p style={{ color: P.dim, fontSize: 13 }}>Based on what youâ€™ve shared, research suggests:</p>
<p style={{ color: P.text, fontSize: 22, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, fontWeight: 500, margin: â€œ12px 0â€ }}>Typical timeline: {age.t}</p>
<p style={{ color: P.muted, fontSize: 13, lineHeight: 1.6 }}>{age.note}</p>
</>}
<div style={{ marginTop: 16, padding: 14, background: `${P.card2}88`, borderRadius: 10, borderLeft: `3px solid ${P.warm}44` }}>
<p style={{ color: P.text, fontSize: 13, lineHeight: 1.6, margin: 0 }}>
This tool wonâ€™t shorten that timeline. It will make the progress within it visible â€” so you donâ€™t abandon whatâ€™s working, and you donâ€™t burn out from effort that feels invisible.
</p>
</div>
</div>
);
})()},
];

const canGo = step === 0 || step === 6
|| (step === 1 && d.childAge) || (step === 2 && d.custody)
|| (step === 3 && d.loyaltyConflict) || (step === 4 && d.yearsInRole)
|| (step === 5 && d.currentState);

return (
<div style={css.root}>
<div style={{ maxWidth: 500, margin: â€œ0 autoâ€, padding: â€œ40px 20pxâ€ }}>
<div style={{ display: â€œflexâ€, gap: 4, marginBottom: 28 }}>
{steps.map((_, i) => <div key={i} style={{ flex: 1, height: 3, borderRadius: 2, background: i <= step ? P.warm : P.border, transition: â€œbackground .3sâ€ }} />)}
</div>
<h2 style={{ color: P.text, fontSize: 22, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, margin: â€œ0 0 6pxâ€ }}>{steps[step].title}</h2>
{steps[step].sub && <p style={{ color: P.dim, fontSize: 14, margin: â€œ0 0 16pxâ€ }}>{steps[step].sub}</p>}
{steps[step].content}
<div style={{ display: â€œflexâ€, gap: 10, marginTop: 28 }}>
{step > 0 && <Btn onClick={() => setStep(s => s - 1)} secondary>Back</Btn>}
<Btn onClick={() => step < steps.length - 1 ? setStep(s => s + 1) : onDone(d)} disabled={!canGo} style={{ flex: 1 }}>
{step === steps.length - 1 ? â€œGet Startedâ€ : â€œContinueâ€}
</Btn>
</div>
</div>
</div>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SHARED UI COMPONENTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function Modal({ children, onClose, title, titleColor, small }) {
return (
<div style={css.overlay} onClick={onClose}>
<div style={{ â€¦css.modal, maxWidth: small ? 400 : 600 }} onClick={e => e.stopPropagation()}>
<div style={{ â€¦css.modalHdr, flexShrink: 0, position: â€œstickyâ€, top: 0, background: P.card, zIndex: 2, borderBottom: `1px solid ${P.border}` }}>
<h2 style={{ â€¦css.modalTitle, color: titleColor || P.text }}>{title}</h2>
<button onClick={onClose} style={css.closeBtn}>{â€\u2715â€}</button>
</div>
<div style={{ padding: â€œ16px 20px 24pxâ€, overflowY: â€œautoâ€, flex: 1, WebkitOverflowScrolling: â€œtouchâ€ }}>{children}</div>
</div>
</div>
);
}

function Btn({ children, onClick, full, secondary, disabled, style }) {
return (
<button
onClick={disabled ? undefined : onClick}
style={{
background: secondary ? P.card2 : `linear-gradient(135deg, ${P.warm}, #C4956A)`,
color: secondary ? P.muted : P.bg,
border: secondary ? `1px solid ${P.border}` : â€œnoneâ€,
borderRadius: 11,
padding: â€œ12px 22pxâ€,
fontSize: 14,
fontWeight: secondary ? 400 : 600,
cursor: disabled ? â€œdefaultâ€ : â€œpointerâ€,
fontFamily: â€œinheritâ€,
width: full ? â€œ100%â€ : â€œautoâ€,
opacity: disabled ? 0.4 : 1,
transition: â€œopacity .2sâ€,
â€¦style,
}}
>
{children}
</button>
);
}

function Chip({ children, active, color, onClick, small }) {
return (
<button onClick={onClick} style={{
padding: small ? â€œ5px 10pxâ€ : â€œ8px 14pxâ€,
borderRadius: small ? 7 : 9,
border: `1px solid ${active ? color : P.border}`,
background: active ? color + â€œ22â€ : â€œtransparentâ€,
color: active ? color : P.dim,
cursor: â€œpointerâ€,
fontSize: small ? 12 : 13,
fontFamily: â€œinheritâ€,
transition: â€œall .15sâ€,
whiteSpace: â€œnowrapâ€,
}}>
{children}
</button>
);
}

function ObBtn({ children, active, onClick }) {
return (
<button onClick={onClick} style={{
padding: â€œ12px 20pxâ€,
borderRadius: 11,
border: `1px solid ${active ? P.warm : P.border}`,
background: active ? P.warm + â€œ18â€ : â€œtransparentâ€,
color: active ? P.warm : P.muted,
cursor: â€œpointerâ€,
fontSize: 14,
fontFamily: â€œinheritâ€,
transition: â€œall .15sâ€,
}}>
{children}
</button>
);
}

function Stat({ n, l }) {
return (
<div style={{ flex: 1, background: P.card, borderRadius: 11, padding: â€œ12px 10pxâ€, textAlign: â€œcenterâ€, border: `1px solid ${P.border}` }}>
<div style={{ color: P.text, fontSize: 18, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, fontWeight: 600 }}>{n}</div>
<div style={{ color: P.dim, fontSize: 10, marginTop: 2 }}>{l}</div>
</div>
);
}

function SectionTitle({ children }) {
return <div style={{ color: P.dim, fontSize: 11, textTransform: â€œuppercaseâ€, letterSpacing: â€œ0.08emâ€, margin: â€œ16px 0 8pxâ€, fontWeight: 500 }}>{children}</div>;
}

function Tabs({ items, active, onPick }) {
return (
<div style={{ display: â€œflexâ€, gap: 3, marginBottom: 14, background: P.card, borderRadius: 9, padding: 3 }}>
{items.map(i => (
<button key={i} onClick={() => onPick(i)} style={{
flex: 1, padding: â€œ8px 10pxâ€, borderRadius: 7, border: â€œnoneâ€, cursor: â€œpointerâ€,
fontSize: 12, fontFamily: â€œinheritâ€, fontWeight: 500,
background: active === i ? P.warm + â€œ28â€ : â€œtransparentâ€,
color: active === i ? P.warm : P.dim,
transition: â€œall .15sâ€,
}}>
{i}
</button>
))}
</div>
);
}

function EntryRow({ entry, onClick }) {
const a = ACTIONS.find(x => x.id === entry.action);
const r = RESPONSES.find(x => x.id === entry.response);
return (
<button onClick={onClick} style={{ â€¦css.card, width: â€œ100%â€, padding: 12, marginBottom: 6, textAlign: â€œleftâ€, cursor: â€œpointerâ€, fontFamily: â€œinheritâ€, border: `1px solid ${P.border}` }}>
<div style={{ display: â€œflexâ€, gap: 10 }}>
{entry.photo && (
<img src={entry.photo} alt=â€â€ style={{ width: 44, height: 44, borderRadius: 7, objectFit: â€œcoverâ€, flexShrink: 0, border: `1px solid ${P.border}` }} />
)}
<div style={{ flex: 1, minWidth: 0 }}>
<div style={{ display: â€œflexâ€, justifyContent: â€œspace-betweenâ€, alignItems: â€œcenterâ€, marginBottom: entry.note ? 4 : 0, flexWrap: â€œwrapâ€, gap: 4 }}>
<span style={{ color: P.dim, fontSize: 11 }}>{fmtShort(entry.date)}</span>
<div style={{ display: â€œflexâ€, gap: 5, alignItems: â€œcenterâ€ }}>
{a && <span style={{ padding: â€œ2px 7pxâ€, borderRadius: 5, fontSize: 11, background: a.c + â€œ1aâ€, color: a.c }}>{a.icon} {a.label}</span>}
{r && <span style={{ padding: â€œ2px 7pxâ€, borderRadius: 5, fontSize: 11, background: r.c + â€œ1aâ€, color: r.c }}>{r.icon}</span>}
</div>
</div>
{entry.note && <p style={{ color: P.muted, fontSize: 12, margin: 0, lineHeight: 1.4 }}>{entry.note.slice(0, 100)}{entry.note.length > 100 ? â€œâ€¦â€ : â€œâ€}</p>}
{entry.contexts?.length > 0 && (
<div style={{ display: â€œflexâ€, gap: 3, flexWrap: â€œwrapâ€, marginTop: 4 }}>
{entry.contexts.map(c => <span key={c} style={{ padding: â€œ1px 5pxâ€, borderRadius: 3, fontSize: 9, color: P.dim, background: P.card2 }}>{c}</span>)}
</div>
)}
</div>
</div>
</button>
);
}

function BenchItem({ label, value }) {
return (
<div style={{ â€¦css.card, padding: 11, display: â€œflexâ€, flexDirection: â€œcolumnâ€, gap: 3 }}>
<span style={{ color: P.dim, fontSize: 11 }}>{label}</span>
<span style={{ color: P.text, fontSize: 13, textTransform: â€œcapitalizeâ€ }}>{value}</span>
</div>
);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STYLES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const css_chip = (active, color) => ({
padding: â€œ4px 9pxâ€,
borderRadius: 7,
border: `1px solid ${active ? color : P.border}`,
background: active ? color + â€œ22â€ : â€œtransparentâ€,
color: active ? color : P.dim,
cursor: â€œpointerâ€,
fontSize: 11,
fontFamily: â€œinheritâ€,
whiteSpace: â€œnowrapâ€,
});

const css = {
root: { background: P.bg, minHeight: â€œ100vhâ€, fontFamily: â€œ-apple-system, BlinkMacSystemFont, â€˜Segoe UIâ€™, Roboto, sans-serifâ€, color: â€œ#D1D5DBâ€, WebkitFontSmoothing: â€œantialiasedâ€ },
shell: { maxWidth: 600, margin: â€œ0 autoâ€, position: â€œrelativeâ€ },
hdr: { padding: â€œ22px 16px 10pxâ€, display: â€œflexâ€, justifyContent: â€œspace-betweenâ€, alignItems: â€œflex-startâ€ },
logo: { fontSize: 26, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, color: P.text, margin: 0, fontWeight: 500, letterSpacing: â€œ-0.02emâ€ },
sub: { fontSize: 11, color: P.dim, margin: â€œ2px 0 0â€, fontStyle: â€œitalicâ€ },
iconBtn: { background: â€œnoneâ€, border: â€œnoneâ€, color: P.dim, cursor: â€œpointerâ€, padding: 8, fontSize: 16 },
nav: { display: â€œflexâ€, borderBottom: `1px solid ${P.border}`, padding: â€œ0 8pxâ€, overflowX: â€œautoâ€ },
navBtn: { flex: 1, background: â€œnoneâ€, border: â€œnoneâ€, cursor: â€œpointerâ€, padding: â€œ11px 6px 9pxâ€, display: â€œflexâ€, flexDirection: â€œcolumnâ€, alignItems: â€œcenterâ€, gap: 2, fontFamily: â€œinheritâ€, transition: â€œcolor .2sâ€ },
fab: { position: â€œfixedâ€, bottom: 22, right: 22, width: 54, height: 54, borderRadius: 27, background: `linear-gradient(135deg, ${P.warm}, #C4956A)`, color: P.bg, border: â€œnoneâ€, cursor: â€œpointerâ€, display: â€œflexâ€, alignItems: â€œcenterâ€, justifyContent: â€œcenterâ€, boxShadow: `0 4px 20px ${P.warm}44`, zIndex: 50 },
card: { background: P.card, borderRadius: 12, border: `1px solid ${P.border}` },
prompt: { width: â€œ100%â€, background: P.card, border: `1px solid ${P.border}`, borderRadius: 12, padding: 14, display: â€œflexâ€, gap: 10, alignItems: â€œflex-startâ€, cursor: â€œpointerâ€, textAlign: â€œleftâ€, marginBottom: 10, fontFamily: â€œinheritâ€ },
overlay: { position: â€œfixedâ€, inset: 0, background: â€œrgba(0,0,0,.72)â€, backdropFilter: â€œblur(4px)â€, zIndex: 100, display: â€œflexâ€, alignItems: â€œflex-endâ€, justifyContent: â€œcenterâ€ },
modal: { background: P.card, borderRadius: â€œ18px 18px 0 0â€, width: â€œ100%â€, maxHeight: â€œcalc(90vh - env(safe-area-inset-top, 0px))â€, overflow: â€œhiddenâ€, border: `1px solid ${P.border}`, borderBottom: â€œnoneâ€, display: â€œflexâ€, flexDirection: â€œcolumnâ€ },
modalHdr: { display: â€œflexâ€, justifyContent: â€œspace-betweenâ€, alignItems: â€œcenterâ€, padding: â€œ18px 20px 0â€, position: â€œstickyâ€, top: 0, background: P.card, zIndex: 10 },
modalTitle: { color: P.text, fontSize: 17, fontFamily: â€œGeorgia, â€˜Times New Romanâ€™, serifâ€, margin: 0, fontWeight: 500 },
closeBtn: { background: â€œnoneâ€, border: â€œnoneâ€, color: P.dim, fontSize: 17, cursor: â€œpointerâ€, padding: 8 },
label: { display: â€œblockâ€, color: P.muted, fontSize: 12, marginBottom: 7, fontWeight: 500 },
dateIn: { background: P.bg, border: `1px solid ${P.border}`, borderRadius: 8, padding: â€œ9px 11pxâ€, color: â€œ#D1D5DBâ€, fontSize: 14, fontFamily: â€œinheritâ€, marginBottom: 14, width: â€œ100%â€, boxSizing: â€œborder-boxâ€, colorScheme: â€œdarkâ€ },
chips: { display: â€œflexâ€, flexWrap: â€œwrapâ€, gap: 7, marginBottom: 14 },
textarea: { width: â€œ100%â€, background: P.bg, border: `1px solid ${P.border}`, borderRadius: 9, padding: 11, color: â€œ#D1D5DBâ€, fontSize: 14, fontFamily: â€œinheritâ€, resize: â€œverticalâ€, boxSizing: â€œborder-boxâ€, lineHeight: 1.5 },
textBtn: { background: â€œnoneâ€, border: â€œnoneâ€, cursor: â€œpointerâ€, fontSize: 13, fontFamily: â€œinheritâ€, padding: â€œ6px 14pxâ€ },
obText: { color: P.muted, fontSize: 15, lineHeight: 1.7, margin: â€œ0 0 12pxâ€ },
th: { color: P.dim, fontSize: 10, fontWeight: 500, padding: â€œ6px 4pxâ€, borderBottom: `1px solid ${P.border}`, textAlign: â€œcenterâ€ },
td: { color: P.muted, fontSize: 11, padding: â€œ8px 4pxâ€, borderBottom: `1px solid ${P.border}`, verticalAlign: â€œtopâ€ },
};

ReactDOM.createRoot(document.getElementById(â€œrootâ€)).render(<App />);
</script>

</body>
</html>